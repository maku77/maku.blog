<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>AppleScriptメモ on まくろぐ</title><link>https://maku.blog/p/2w8khvx/</link><description>Recent content in AppleScriptメモ on まくろぐ</description><generator>Hugo</generator><language>ja-jp</language><lastBuildDate>Sun, 18 Feb 2018 00:00:00 +0900</lastBuildDate><atom:link href="https://maku.blog/p/2w8khvx/index.xml" rel="self" type="application/rss+xml"/><item><title>Macメモ: AppleScript を実行する</title><link>https://maku.blog/p/6je96q9/</link><pubDate>Sun, 18 Feb 2018 00:00:00 +0900</pubDate><guid>https://maku.blog/p/6je96q9/</guid><description>&lt;p>macOS の AppleScript を使用すると、実行したい一連の処理をスクリプト化することができます。
Windows のバッチファイルのようなものです。
AppleScript を実行するには、&lt;strong>&lt;code>osascript&lt;/code>&lt;/strong> コマンドを使用します。&lt;/p>
&lt;h2 id="ワンライナーで実行する">ワンライナーで実行する&lt;/h2>
&lt;p>次のようにして、&lt;strong>&lt;code>-e&lt;/code>&lt;/strong> オプションで実行する処理を直接記述することができます。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">例: ダイアログでメッセージを表示する&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> osascript -e &lt;span class="s1">&amp;#39;display dialog &amp;#34;Hello&amp;#34;&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;h2 id="スクリプトファイルを実行する">スクリプトファイルを実行する&lt;/h2>
&lt;p>長いスクリプトを作成するときは、次のようにスクリプトファイルとして保存しておくのがよいでしょう。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">sample.osa（スクリプトファイル）&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#!/usr/bin/env osascript
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">display dialog &lt;span class="s2">&amp;#34;Hello&amp;#34;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>スクリプトファイルを実行するときは、ファイル名をそのままパラメーターとして指定します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> osascript sample.osa
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>上記のスクリプト例のように 1 行目にシェバング (&lt;code>#!&lt;/code>) を記述した上で実行権限を付けておけば、そのまま実行ファイルとして実行することができます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> chmod +x sample.osa
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> ./sample.osa
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Macメモ: AppleScript でコメントを記述する</title><link>https://maku.blog/p/h3zmh7k/</link><pubDate>Sun, 18 Feb 2018 00:00:00 +0900</pubDate><guid>https://maku.blog/p/h3zmh7k/</guid><description>&lt;p>AppleScript にも C++ や Java のように、行コメントとブロックコメントのための構文が用意されています。&lt;/p>
&lt;h2 id="行コメント">行コメント&lt;/h2>
&lt;pre tabindex="0">&lt;code>-- コメント
&lt;/code>&lt;/pre>&lt;p>&lt;code>--&lt;/code> 以降に記述したテキストは、行末までコメントとみなされ実行時に無視されます。&lt;/p>
&lt;h2 id="ブロックコメント">ブロックコメント&lt;/h2>
&lt;pre tabindex="0">&lt;code>(*
 コメント
 コメント
 -- 行コメントをネストすることもできます
 (* ブロックコメントをネストすることもできます *)
*)
&lt;/code>&lt;/pre>&lt;p>複数行に渡るコメントを記述したいときは、&lt;code>(*&lt;/code> と &lt;code>*)&lt;/code> で囲みます。
Java や C/C++ とは異なり、ブロックコメントの中にブロックコメントを入れ子で含めることができます。&lt;/p></description></item><item><title>Macメモ: AppleScript でターミナルを操作する</title><link>https://maku.blog/p/dgde4df/</link><pubDate>Sun, 18 Feb 2018 00:00:00 +0900</pubDate><guid>https://maku.blog/p/dgde4df/</guid><description>&lt;h2 id="新規ターミナルウィンドウを開く">新規ターミナルウィンドウを開く&lt;/h2>
&lt;p>macOS で次のシェルスクリプトを実行すると、新しいターミナルを起動してそのターミナルをアクティブにすることができます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#!/usr/bin/env osascript
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tell application &lt;span class="s2">&amp;#34;Terminal&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">do&lt;/span> script
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> activate
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">end tell
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>上記はスクリプトファイルにする例ですが、次のように、ワンライナーで &lt;code>osascript&lt;/code> コマンドを実行することもできます。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> osascript -e &lt;span class="s1">&amp;#39;tell application &amp;#34;Terminal&amp;#34; to do script&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>新規に開いたターミナル上で任意のシェルコマンドを実行するには、&lt;strong>&lt;code>do script&lt;/code>&lt;/strong> のパラメータでコマンドを指定します。
次の例では、単純な &lt;code>echo&lt;/code> コマンドを実行しています。&lt;/p>
&lt;pre tabindex="0">&lt;code>tell application &amp;#34;Terminal&amp;#34;
 do script &amp;#34;echo Hello&amp;#34;
 activate
end tell
&lt;/code>&lt;/pre>&lt;p>さらに、次のようにすれば、新規ターミナルのタイトルを設定することができます。&lt;/p>
&lt;pre tabindex="0">&lt;code>tell application &amp;#34;Terminal&amp;#34;
 do script
 activate

 set currWin to index of first window
 tell window currWin
 set custom title of first tab to &amp;#34;カスタムタイトル&amp;#34;
 end tell
end tell
&lt;/code>&lt;/pre>&lt;p>ターミナルのテーマを変更することもできます。&lt;/p>
&lt;pre tabindex="0">&lt;code>set current settings of window currWin to settings set &amp;#34;Grass&amp;#34;
&lt;/code>&lt;/pre>&lt;h2 id="新しいタブを開く">新しいタブを開く&lt;/h2>
&lt;p>次の例では、ターミナルに対して &lt;kbd>Command + T&lt;/kbd> イベントを送信して、新しいタブを開いています。&lt;/p></description></item><item><title>Macメモ: AppleScript でボタンによる選択肢を表示する</title><link>https://maku.blog/p/g4cq4uh/</link><pubDate>Sun, 18 Feb 2018 00:00:00 +0900</pubDate><guid>https://maku.blog/p/g4cq4uh/</guid><description>&lt;p>下記のサンプルでは、"Windows" "Mac" "Cancel" の３つのボタンを表示し、押したボタンによって異なるメッセージを表示します。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#!/usr/bin/env osascript
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">display dialog &lt;span class="s2">&amp;#34;Select your OS&amp;#34;&lt;/span> buttons &lt;span class="o">{&lt;/span>&lt;span class="s2">&amp;#34;Mac&amp;#34;&lt;/span>, &lt;span class="s2">&amp;#34;Windows&amp;#34;&lt;/span>, &lt;span class="s2">&amp;#34;Cancel&amp;#34;&lt;/span>&lt;span class="o">}&lt;/span> default button &lt;span class="m">3&lt;/span> with icon note
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">copy the result as list to &lt;span class="o">{&lt;/span>ret&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> the ret is &lt;span class="s2">&amp;#34;Windows&amp;#34;&lt;/span> &lt;span class="k">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> display dialog &lt;span class="s2">&amp;#34;You are using Windows!&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> the ret is &lt;span class="s2">&amp;#34;Mac&amp;#34;&lt;/span> &lt;span class="k">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> display dialog &lt;span class="s2">&amp;#34;You are using Mac!&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">end &lt;span class="k">if&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Macメモ: AppleScript で変数を定義する</title><link>https://maku.blog/p/zpg5wns/</link><pubDate>Sun, 18 Feb 2018 00:00:00 +0900</pubDate><guid>https://maku.blog/p/zpg5wns/</guid><description>&lt;p>AppleScript で変数に値を代入するには、&lt;strong>&lt;code>set&lt;/code>&lt;/strong> あるいは &lt;strong>&lt;code>copy&lt;/code>&lt;/strong> を使用します。&lt;/p>
&lt;p>次の例では、&lt;code>set&lt;/code> を使って、変数 &lt;code>user&lt;/code> に文字列 &lt;code>&amp;quot;Maku&amp;quot;&lt;/code> を代入しています。&lt;/p>
&lt;pre tabindex="0">&lt;code>set user to &amp;#34;Maku&amp;#34;
display dialog &amp;#34;Hello &amp;#34; &amp;amp; user
&lt;/code>&lt;/pre>&lt;p>&lt;code>set&lt;/code> の代わりに、&lt;code>copy&lt;/code> を使用することもできます。&lt;/p>
&lt;pre tabindex="0">&lt;code>copy 33 to myAge
&lt;/code>&lt;/pre></description></item></channel></rss>