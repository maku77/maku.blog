<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Ansible の操作／設定 on まくろぐ</title><link>https://maku.blog/p/u6p6n4i/</link><description>Recent content in Ansible の操作／設定 on まくろぐ</description><generator>Hugo -- gohugo.io</generator><language>ja-jp</language><lastBuildDate>Mon, 18 Jul 2022 00:00:00 +0000</lastBuildDate><atom:link href="https://maku.blog/p/u6p6n4i/index.xml" rel="self" type="application/rss+xml"/><item><title>Ansible の SSH 接続で使用するユーザーと秘密鍵を指定する</title><link>https://maku.blog/p/n3jygwd/</link><pubDate>Mon, 18 Jul 2022 00:00:00 +0000</pubDate><guid>https://maku.blog/p/n3jygwd/</guid><description>Ansible コマンド（ansible や ansible-playbook）でマネージドノードを制御するとき、デフォルトでは SSH ユーザーとしてコントロールノードのカレントユーザーが使用されます。 異なる SSH ユーザー（と秘密鍵）で接続したい場合は、コマンドライン引数やインベントリファイルで指定することができます。
コマンドライン引数で指定する方法 インベントリファイルで指定する方法 ansible.cfg でデフォルトユーザーを指定する方法 ~/.ssh/config で接続先ごとにユーザーを指定する方法 コマンドライン引数で SSH ユーザーを指定する方法 ansible-playbook コマンドの、-u (--user) オプションで SSH 接続に使用するユーザー名、--private-key オプションで秘密鍵を指定することができます。
$ ansible-playbook -i hosts.ini site.yml -u maku --private-key ~/.ssh/maku/id_rsa インベントリファイルで SSH ユーザーを指定する方法 インベントリファイルで指定する場合は、ansible_user 変数と ansible_ssh_private_key 変数を使います。
hosts.ini（ホストごとに指定する場合） [servers] www1.example.com ansible_user=maku ansible_ssh_private_key_file=~/.ssh/maku/id_rsa www2.example.com ansible_user=maku ansible_ssh_private_key_file=~/.ssh/maku/id_rsa hosts.ini（グループ単位で指定する場合） [servers] www1.example.com www2.example.com [servers:vars] ansible_user=maku ansible_ssh_private_key_file=~/.ssh/maku/id_rsa YAML 形式でインベントリファイルを記述する場合も、同様の変数で設定できます。
hosts.yml all: hosts: www1.example.com: www2.example.com: vars: ansible_user: maku ansible_ssh_private_key_file: ~/.ssh/maku/id_rsa ~/.ssh/config で接続先ごとにユーザーを指定する方法 インベントリファイルに SSH のユーザー名や秘密鍵のパスを記述するのが煩わしいときは、SSH クライアントの設定ファイル (~/.</description></item><item><title>Ansible の ansible.cfg ファイルの検索順序</title><link>https://maku.blog/p/pamv6gq/</link><pubDate>Sun, 23 Oct 2016 00:00:00 +0000</pubDate><guid>https://maku.blog/p/pamv6gq/</guid><description>Ansible の実行環境が参照する設定ファイル (ansible.cfg) は、下記のようなパスから検索されます。
環境変数 ANSIBLE_CONFIG で指定されたファイル ansible.cfg（カレントディレクトリ以下のファイル） ~/.ansible.cfg（ホームディレクトリ以下のファイル） /etc/ansible/ansible.cfg Git などで管理する場合は、Playbook の近くに一緒に入れておくとわかりやすいです（上記の 2 番目の方法）。</description></item><item><title>Ansible でインベントリーファイルの場所を指定する</title><link>https://maku.blog/p/eycnx9i/</link><pubDate>Sat, 22 Oct 2016 00:00:00 +0000</pubDate><guid>https://maku.blog/p/eycnx9i/</guid><description>Ansible のコマンド（ansible や ansible-playbook）を実行すると、下記の順でインベントリーファイルが検索されます。
コマンドラインオプション -i で指定したファイル コンフィグファイル ansible.cfg 内の hostfile で指定したファイル（参考: ansible.cfg ファイルの検索パス） /etc/ansible/inventry 以下の例は、いずれもカレントディレクトリ内の hosts というファイルをインベントリファイルとして使用するように指定しています。
例: コマンドラインオプション (-i) で指定する方法 $ ansible myserver -i hosts -m ping 例: コンフィグファイル (ansible.cfg) で指定する方法 [defaults] hostfile = hosts</description></item></channel></rss>