<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>プログラム雑多メモ on まくろぐ</title><link>https://maku.blog/p/sfs4fq2/</link><description>Recent content in プログラム雑多メモ on まくろぐ</description><generator>Hugo</generator><language>ja-jp</language><lastBuildDate>Fri, 09 Jun 2023 00:00:00 +0900</lastBuildDate><atom:link href="https://maku.blog/p/sfs4fq2/index.xml" rel="self" type="application/rss+xml"/><item><title>プログラムでレインボーカラー（虹色）のグラデーションを作成するには</title><link>https://maku.blog/p/4cbbh6o/</link><pubDate>Mon, 09 Dec 2019 00:00:00 +0900</pubDate><guid>https://maku.blog/p/4cbbh6o/</guid><description>&lt;p>とあるコーディングにおいて、色を滑らかに変化させる必要があったのでメモメモ。&lt;/p>
&lt;h2 id="rgb-ではなく-hsv-で考える">RGB ではなく HSV で考える&lt;/h2>
&lt;p>何らかのプログラミング言語から虹色のグラデーションを作る必要がある場合、RGB の色空間で色調整を行うのは大変ですが、HSV の色空間で考えると簡単に表現することができます。&lt;/p>


&lt;figure class="xImage">
 &lt;img style="" width="160" height="160" src="../../p/4cbbh6o/hsv.png" alt="/p/4cbbh6o/hsv.png" />
 &lt;figcaption>図: HSV 色空間&lt;/figcaption>
&lt;/figure>

&lt;ul>
&lt;li>参考: &lt;a href="https://ja.wikipedia.org/wiki/HSV%E8%89%B2%E7%A9%BA%E9%96%93">HSV 色空間 - Wikipedia&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>HSV はそれぞれ下記のような情報を表しており、&lt;/p>
&lt;ul>
&lt;li>色相 (Hue): 0～360&lt;/li>
&lt;li>彩度 (Saturation・Chroma): 0～1&lt;/li>
&lt;li>明度 (Value・Brightness): 0～1&lt;/li>
&lt;/ul>
&lt;p>このうち、色相 (Hue) の値を 0～360 の間で変化させてやることでレインボーカラーを表現することができます。&lt;/p>
&lt;h2 id="プログラムのサンプル">プログラムのサンプル&lt;/h2>


&lt;figure class="xImage">
 &lt;img style="" width="240" height="79" src="../../p/4cbbh6o/rainbow-bar.png" alt="/p/4cbbh6o/rainbow-bar.png" />
 &lt;figcaption>図: 虹色グラデーションの描画&lt;/figcaption>
&lt;/figure>

&lt;p>例えば、Android では、&lt;code>android.graphics.Color.HSVToColor()&lt;/code> という関数を使用すると、HSV 色空間における値を、描画に使用するカラーデータに変換することができます。&lt;/p>
&lt;p>下記の &lt;code>ColorGenerator&lt;/code> クラスの &lt;code>nextColor()&lt;/code> メソッドを連続して呼び出すと、徐々に変わっていく色をひとつずつ取り出すことができます。
やっていることは、メソッドの呼び出しごとに、色相 (Hue) の値を少しずつ変化させているだけです。
色相 (Hue) が、何度の &lt;code>nextColor()&lt;/code> 呼び出しで一周するかは、コンストラクタの &lt;code>steps&lt;/code> パラメータで指定できるようにしています。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">ColorGenerator.kt&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-kotlin" data-lang="kotlin">&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">ColorGenerator&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">val&lt;/span> &lt;span class="py">steps&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Int&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">initialHue&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Float&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="m">0.0F&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">private&lt;/span> &lt;span class="k">val&lt;/span> &lt;span class="py">hueStep&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Float&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="m">360F&lt;/span> &lt;span class="p">/&lt;/span> &lt;span class="n">steps&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">private&lt;/span> &lt;span class="k">var&lt;/span> &lt;span class="py">currentHue&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">initialHue&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">fun&lt;/span> &lt;span class="nf">nextColor&lt;/span>&lt;span class="p">():&lt;/span> &lt;span class="n">Int&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">val&lt;/span> &lt;span class="py">hsv&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">floatArrayOf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">currentHue&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">1.0F&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">1.0F&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">val&lt;/span> &lt;span class="py">color&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Int&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nc">Color&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">HSVToColor&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="m">255&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">hsv&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">currentHue&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">currentHue&lt;/span> &lt;span class="p">+&lt;/span> &lt;span class="n">hueStep&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">%&lt;/span> &lt;span class="m">360F&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">color&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>次のコードは、このクラスを使って、虹色のグラデーション（細い矩形の連続）を描画するコードの抜粋です。
ここでは、色を 30 段階に分けて描画しています。&lt;/p></description></item><item><title>C# で Microsoft Outlook の情報を取得する</title><link>https://maku.blog/p/eb5nx4z/</link><pubDate>Mon, 18 Jun 2018 00:00:00 +0900</pubDate><guid>https://maku.blog/p/eb5nx4z/</guid><description>&lt;p>組織内で Outlook を使用している場合は、プログラムから Outlook の情報（Exchange サーバの情報）を取得してごにょごにょすると、日々の作業を効率化できるかもしれません。
ここでは、C# から Outlook の情報を取得する方法を紹介します。&lt;/p>
&lt;p>プログラミング言語に C# を使っていますが、もともとは VBA などのインタフェース (COM) として使われていたものなので、本格的にコーディングするときは、VBA のリファレンスが参考になります。&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://msdn.microsoft.com/ja-jp/vba/vba-outlook">Outlook VBA リファレンス｜MSDN&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>以下のサンプルは、Visual Studio Community 2017 を使って確認しています。
Visual Studio で新規のプロジェクト（ここではシンプルにコンソールアプリを選択）を作成したら、まずは次のようにして Outlook のインタフェースの参照を追加してください。&lt;/p>
&lt;ol>
&lt;li>プロジェクト(P) → 参照の追加(R)&lt;/li>
&lt;li>COM → &lt;strong>Microsoft Outlook 14.0 Object Library&lt;/strong>&lt;/li>
&lt;/ol>
&lt;p>次のコードは、現在 Outlook を使用しているユーザの名前とメールアドレス、および上司の名前とメールアドレスを表示します。&lt;/p>

&lt;figure class="xCodeBlock">

&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="k">using&lt;/span> &lt;span class="nn">System&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">using&lt;/span> &lt;span class="nn">Outlook&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">Microsoft&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Office&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Interop&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Outlook&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">namespace&lt;/span> &lt;span class="nn">ConsoleApp1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">class&lt;/span> &lt;span class="nc">Program&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">static&lt;/span> &lt;span class="n">Outlook&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Application&lt;/span> &lt;span class="n">outlookApp&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="n">Outlook&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Application&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// Exchange ユーザの情報を表示する&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">static&lt;/span> &lt;span class="k">void&lt;/span> &lt;span class="n">ShowRecipientInfo&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Outlook&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">ExchangeUser&lt;/span> &lt;span class="n">user&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Console&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">WriteLine&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">user&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Name&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// 名前&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Console&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">WriteLine&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">user&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">PrimarySmtpAddress&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// メールアドレス&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">static&lt;/span> &lt;span class="k">void&lt;/span> &lt;span class="n">Main&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">string&lt;/span>&lt;span class="p">[]&lt;/span> &lt;span class="n">args&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// カレントユーザーの情報を表示&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Outlook&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Recipient&lt;/span> &lt;span class="n">rcp&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">outlookApp&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Session&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">CurrentUser&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Outlook&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">ExchangeUser&lt;/span> &lt;span class="n">currentUser&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">rcp&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">AddressEntry&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">GetExchangeUser&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ShowRecipientInfo&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">currentUser&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// 上司の情報を表示&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Outlook&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">ExchangeUser&lt;/span> &lt;span class="n">manager&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="n">currentUser&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">GetExchangeUserManager&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">manager&lt;/span> &lt;span class="p">!=&lt;/span> &lt;span class="kc">null&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ShowRecipientInfo&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>


&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">実行結果&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">Yamada Taro
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">yamada-taro@example.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Tokoro George
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tokoro-george@example.com&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;h2 id="参考">参考&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://msdn.microsoft.com/ja-jp/library/office/bb612741.aspx">Office - Dev Center - 操作方法 (Outlook リファレンス)&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>文字列の類似度を計算する（LCS: 最長共通部分列）</title><link>https://maku.blog/p/a3jyhwd/</link><pubDate>Thu, 20 Nov 2014 00:00:00 +0900</pubDate><guid>https://maku.blog/p/a3jyhwd/</guid><description>&lt;h2 id="lcs-とは">LCS とは&lt;/h2>
&lt;p>&lt;strong>LCS: Longest Common Subsequence（最長共通部分列）&lt;/strong> 問題とは、2 つのシーケンスから最長の共通部分列を探す問題です。&lt;/p>
&lt;ul>
&lt;li>参考: &lt;a href="http://en.wikipedia.org/wiki/Longest_common_subsequence_problem">Wikipedia - Longest common subsequence problem&lt;/a>&lt;/li>
&lt;li>参考: &lt;a href="http://ja.wikipedia.org/wiki/%E6%9C%80%E9%95%B7%E5%85%B1%E9%80%9A%E9%83%A8%E5%88%86%E5%88%97%E5%95%8F%E9%A1%8C">Wikipedia - 最長共通部分列問題&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>部分列は飛び飛びの要素で構成されていても構いませんが、順番はキープして作成する必要があります。下記の例は、2 つの文字列とその最長共通部分列 (LCS) を示したものです。&lt;/p>
&lt;ul>
&lt;li>文字列1: "ABCDCE"&lt;/li>
&lt;li>文字列2: "ACCDEX"&lt;/li>
&lt;li>LCS: "ACCE" or "ACDE"&lt;/li>
&lt;/ul>
&lt;h2 id="lcs-の計算方法">LCS の計算方法&lt;/h2>
&lt;p>LCS は、動的計画法（DP: Dynamic Programming）の例題としてよく示される問題で、DP を使うことで効率的に答えを求めることができます。
考え方としては、下記のような文字列の入ったスタックから、任意の順番で文字を取り出していく問題だとみなすと分かりやすいです。&lt;/p>


&lt;figure class="xImage">
 &lt;img style="" width="253" height="268" src="../../p/a3jyhwd/img-001.png" alt="/p/a3jyhwd/img-001.png" />
&lt;/figure>

&lt;p>どちらか一方から要素を取り出すときは、文字をマッチさせないと考えます。
両方の要素を同時に取り出すときは、そのタイミングで文字をマッチさせる（LCS を構成する要素）と考えます。&lt;/p>


&lt;figure class="xImage">
 &lt;img style="" width="252" height="251" src="../../p/a3jyhwd/img-002.png" alt="/p/a3jyhwd/img-002.png" />
&lt;/figure>

&lt;p>このように、任意の順番で取り出してマッチングしていったときに、最大の一致数になったものが LCS ということになります。&lt;/p>
&lt;p>ここでは、DP（動的計画法）を使って、文字列 1 と文字列 2 の LCS の長さを求めるコードを考えてみます。&lt;/p>
&lt;ul>
&lt;li>文字列 1 の長さを &lt;code>Len1&lt;/code>、文字列 2 の長さを &lt;code>Len2&lt;/code> とします。&lt;/li>
&lt;li>&lt;code>dp[i][j]&lt;/code> には、文字列 1 の &lt;code>j&lt;/code> 文字目までの部分文字列と、文字列 2 の &lt;code>i&lt;/code> 文字目までの部分文字列を一致させた場合 LCS の長さを格納します。&lt;/li>
&lt;/ul>
&lt;p>まず、0 文字の部分文字列同士の LCS は当然 0 文字なので、&lt;/p></description></item><item><title>文字列の類似度を計算する（レーベンシュタイン距離）</title><link>https://maku.blog/p/xjw9ju7/</link><pubDate>Tue, 18 Nov 2014 00:00:00 +0900</pubDate><guid>https://maku.blog/p/xjw9ju7/</guid><description>&lt;h2 id="レーベンシュタイン距離とは">レーベンシュタイン距離とは&lt;/h2>
&lt;p>&lt;strong>レーベンシュタイン距離 (Levenshtein Distance)&lt;/strong> は、ある文字列に対して、何回の変更処理（削除、挿入、置換）を行えば対象の文字列に変換できるかを示します。&lt;/p>
&lt;ul>
&lt;li>参考: &lt;a href="http://en.wikipedia.org/wiki/Levenshtein_distance">Wikipedia - Levenshtein distance&lt;/a>&lt;/li>
&lt;li>参考: &lt;a href="http://ja.wikipedia.org/wiki/%E3%83%AC%E3%83%BC%E3%83%99%E3%83%B3%E3%82%B7%E3%83%A5%E3%82%BF%E3%82%A4%E3%83%B3%E8%B7%9D%E9%9B%A2">Wikipedia - レーベンシュタイン距離&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>レーベンシュタイン距離を効率的に計算するために、一般的に DP マッチング（動的計画法による距離計算）が使用されます（ここでは文字列間の距離を求めていますが、DP マッチングは単純に二つの波形を伸縮させながらマッチングするためにも使用されます）。
下記に詳細なマッチングの過程を示します。&lt;/p>
&lt;h2 id="2-つの文字列のレーベンシュタイン距離を求める">2 つの文字列のレーベンシュタイン距離を求める&lt;/h2>
&lt;p>次のような文字列 A と文字列 B のレーベンシュタイン距離を求めるとします。&lt;/p>
&lt;ul>
&lt;li>文字列 A = "CARROT"&lt;/li>
&lt;li>文字列 B = "CAT"&lt;/li>
&lt;/ul>
&lt;p>文字列 A の文字数が &lt;code>i&lt;/code> 文字、文字列 B の文字数が &lt;code>j&lt;/code> 文字だとした場合の距離（最短変換数）を格納するための &lt;code>dp&lt;/code> 配列を用意します。&lt;/p>

&lt;figure class="xCodeBlock">

&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">dp[LenA + 1, LenB + 1]&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>下記の図は、この配列を表にしたものです。&lt;/p>


&lt;figure class="xImage">
 &lt;img style="" width="455" height="312" src="../../p/xjw9ju7/img-001.png" alt="/p/xjw9ju7/img-001.png" />
&lt;/figure>

&lt;p>セル内の数値は文字列を一致させるのに費やした変換手順数を表しており、&lt;code>dp[0, 0]&lt;/code> は文字列 A も文字列 B も空文字だった場合の距離なので 0 です（空文字から空文字に変換するまでの手順数です）。
この表に左下から順番に手順数を埋めていき、最終的に右上の G が示している &lt;code>dp[7, 4]&lt;/code> に文字列 A と文字列 B の距離が格納されます（"CAT" を "CARROT" に変換する手順数）。&lt;/p></description></item><item><title>private メソッドのユニットテストが書きたくなったら</title><link>https://maku.blog/p/nvetfsf/</link><pubDate>Thu, 16 Oct 2014 00:00:00 +0900</pubDate><guid>https://maku.blog/p/nvetfsf/</guid><description>&lt;p>private メソッドをテストすべきかどうかは色々意見がありますが、あるクラスの private メソッドの割合が、public メソッドに比べて非常に多くなった場合は、private メソッドのテストも書きたくなるかもしれません。&lt;/p>
&lt;p>そのような場合は、&lt;strong>クラス抽出のリファクタリングを考える&lt;/strong>とよいです。
特定の処理がクラスとして抽出されれば、そのクラスを利用するインタフェースは public メソッドになるので、自然にテストを記述できるようになります。
もとのクラスの見通しもよくなり、一石二鳥です。&lt;/p>
&lt;p>計算処理を担うようなメソッドはテストを記述するよい対象になりますが、private メソッドのままではテストが記述できません。
そのような場合は、&lt;strong>public static なユーティリティメソッドに変更する&lt;/strong>ことで、テストを記述できるようにするとよいです。
そのメソッド内でフィールドにアクセスしないユーティリティメソッドになっていれば（ステートレス）、オブジェクトに副作用を与えることはないので、public メソッドにしても悪影響は出ません（カプセル化は崩れない）。&lt;/p>
&lt;p>JxUnit のように private メソッドをテスト可能なフレームワークを使用するのもひとつの手です。
JxUnit は内部でリフレクションを利用して private メソッドのテストを可能にしています。&lt;/p></description></item><item><title>Groovy をインストールする</title><link>https://maku.blog/p/vtfddwb/</link><pubDate>Fri, 30 May 2014 00:00:00 +0900</pubDate><guid>https://maku.blog/p/vtfddwb/</guid><description>&lt;h2 id="macosx-に-groovy-をインストールする">MacOSX に Groovy をインストールする&lt;/h2>
&lt;p>&lt;strong>GVM: Groovy enVironment Manager&lt;/strong> を使うと複数バージョンの Groovy を管理することができます。
ここでは、GVM を使って Groovy の環境をインストールする手順を示します。&lt;/p>
&lt;h3 id="1-gvm-のインストール">1. GVM のインストール&lt;/h3>
&lt;pre tabindex="0">&lt;code>$ curl -s get.gvmtool.net | bash
&lt;/code>&lt;/pre>&lt;p>これで、&lt;code>.bash_profile&lt;/code> に以下のように追加されて &lt;code>gvm&lt;/code> コマンドにパスが通ります。&lt;/p>
&lt;pre tabindex="0">&lt;code>#THIS MUST BE AT THE END OF THE FILE FOR GVM TO WORK!!!
[[ -s &amp;#34;/Users/maku/.gvm/bin/gvm-init.sh&amp;#34; ]] &amp;amp;&amp;amp; source &amp;#34;/Users/maku/.gvm/bin/gvm-init.sh&amp;#34;
&lt;/code>&lt;/pre>&lt;h3 id="2-gvm-で-groovy-のインストール">2. GVM で groovy のインストール&lt;/h3>
&lt;pre tabindex="0">&lt;code>$ gvm list groovy # インストール可能なバージョン確認
$ gvm install groovy # 最新版のインストール
$ gvm install groovy 2.3.2 # バージョンを指定してインストール
&lt;/code>&lt;/pre>&lt;p>これで、&lt;code>groovy&lt;/code> や &lt;code>groovysh&lt;/code> コマンドが使用できるようになります。
使用中の &lt;code>groovy&lt;/code> のバージョンの確認、切り替えは以下のように行います。&lt;/p></description></item><item><title>HMAC-SHA256 コードを生成する</title><link>https://maku.blog/p/uqhbb5p/</link><pubDate>Fri, 02 Aug 2013 00:00:00 +0900</pubDate><guid>https://maku.blog/p/uqhbb5p/</guid><description>&lt;h2 id="python-で-hmac-sha256-を生成する">Python で HMAC-SHA256 を生成する&lt;/h2>
&lt;p>下記の &lt;code>siggen.py&lt;/code> スクリプトは、コマンドライン引数で渡された「秘密鍵テキスト」と「メッセージ」をもとに &lt;a href="https://ja.wikipedia.org/wiki/HMAC">HMAC (Hash-based Message Authentication Code)&lt;/a> 署名を生成します。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">siggen.py&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">sys&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">hashlib&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">hmac&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">usage&lt;/span>&lt;span class="p">():&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;python &amp;#39;&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">sys&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">argv&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="s1">&amp;#39; &amp;lt;key&amp;gt; &amp;lt;message&amp;gt;&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sys&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">exit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="vm">__name__&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s1">&amp;#39;__main__&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nb">len&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sys&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">argv&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">usage&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">key&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">sys&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">argv&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">msg&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">sys&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">argv&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sig&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">hmac&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">key&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">encode&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;ascii&amp;#39;&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">msg&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">encode&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;ascii&amp;#39;&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">hashlib&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sha256&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sig&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">hexdigest&lt;/span>&lt;span class="p">())&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>


&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">使用例&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">$ python siggen.py &amp;#39;SecretKey&amp;#39; &amp;#39;YourMessage&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">8aff2951003c218bd26ee43c99e30527a0c30e06042008a60935ef1ab28891ec&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>ここでは、SHA256 ハッシュ関数を使用していますが (HMAC-SHA256)、&lt;code>hashlib.sha256&lt;/code> の部分を変更すれば、他のハッシュ関数を適用することができます。&lt;/p>
&lt;h2 id="openssl-コマンドで-hmac-sha256-を生成する">openssl コマンドで HMAC-SHA256 を生成する&lt;/h2>
&lt;p>Linux や macOS などの、&lt;code>openssl&lt;/code> コマンドを使用できる環境では、下記のようにして簡単に HMAC-SHA256 を求めることができます。&lt;/p>

&lt;figure class="xCodeBlock">

&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">$ echo -n &amp;#39;YourMessage&amp;#39; | openssl dgst -sha256 -hmac &amp;#39;SecretKey&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">8aff2951003c218bd26ee43c99e30527a0c30e06042008a60935ef1ab28891ec&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;h2 id="おまけランダムで秘密鍵テキストを生成するスクリプト">おまけ（ランダムで秘密鍵テキストを生成するスクリプト）&lt;/h2>
&lt;p>下記の &lt;code>random-password.py&lt;/code> スクリプトは、HMAC 計算に使用可能な 20 桁のランダムな文字列（秘密鍵）を生成します。
上記の &lt;code>siggen.py&lt;/code> スクリプトに入力する秘密鍵として使用することができます。&lt;/p></description></item><item><title>ソフトウェア開発手法のまとめ</title><link>https://maku.blog/p/herfwex/</link><pubDate>Sun, 04 Nov 2012 00:00:00 +0900</pubDate><guid>https://maku.blog/p/herfwex/</guid><description>&lt;ul>
&lt;li>XP (eXtream Programming)
&lt;ul>
&lt;li>Kent Beck が指揮。&lt;/li>
&lt;li>12 のプラクティスがあり、それぞれが連携している。&lt;/li>
&lt;li>顧客との連携を重視する。「オンサイト顧客」というプラクティスでは、開発チームに顧客を含めてしまう。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>SCRUM
&lt;ul>
&lt;li>マイクロソフトで発祥。&lt;/li>
&lt;li>マネジメントに焦点を当てたプロセス。&lt;/li>
&lt;li>それぞれの役割に、強い権力付けがされているのが特徴。&lt;/li>
&lt;li>1ヶ月のスプリントの間、スクラムマスターはスクラムチームを外の雑音から守る。&lt;/li>
&lt;li>約10分で終わるスタンドアップミーティングで一日を始める。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>クリスタル
&lt;ul>
&lt;li>Alistair Cockburn が提唱するプロジェクトのテンプレート群。&lt;/li>
&lt;li>メンバー数などから、クリスタルクリア、イエロー、オレンジ、レッドと分類される。&lt;/li>
&lt;li>規模が大きくなると、ドキュメントを多く作るような規則になっていく。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>ASD (Adaptive Software Development)
&lt;ul>
&lt;li>Jim Highsmith と Sam Bayer が作成。&lt;/li>
&lt;li>RAD (Rapid Application Development) の考えから作成されたアジャイル開発プロセス。&lt;/li>
&lt;li>複雑性の理論により、「Speculate（推測） ➡ Collaborate（強調） ➡ Learn（学習）」の繰り返しでプロジェクトを順応させていく。&lt;/li>
&lt;li>大規模開発は、メンバー数を増やすことで可能にする。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>リーン開発
&lt;ul>
&lt;li>Poppendieck 夫妻が提唱。&lt;/li>
&lt;li>無駄を省きながらプロジェクトを進める開発手法。&lt;/li>
&lt;li>プロジェクト開発中の待ち時間になっている部分を少なくすることでプロジェクトを短期間に終わらせようとする考え。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>FDD (Feature Driven Development)
&lt;ul>
&lt;li>ボーランドが提唱。&lt;/li>
&lt;li>開発の単位を「機能」とする。&lt;/li>
&lt;li>機能のリリースは2週間単位。&lt;/li>
&lt;li>機能の完成度は「赤：未着手」「黄：作業中」「緑：完成」の3段階のみで表現。&lt;/li>
&lt;li>機能単位で担当を割り当てる。クラス単位で担当を決めることで、人同士のやり取りが、クラス間のやり取りに等しくなるという利点がある。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>TDD (Test Driven Development)
&lt;ul>
&lt;li>XP と同じ Kent Beck が提唱。&lt;/li>
&lt;li>XP のテストファーストの考え方を、プロセス全体に適用したもの。&lt;/li>
&lt;li>GUI の開発であっても、クラスを疎結合にすることで、テストの自動化を考える。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul></description></item><item><title>クワイン・マクラスキー法 (Quine-McCluskey algorithm)</title><link>https://maku.blog/p/m4x8mcw/</link><pubDate>Fri, 20 Jun 2008 00:00:00 +0900</pubDate><guid>https://maku.blog/p/m4x8mcw/</guid><description>&lt;p>カルノー・マップを用いた Bool 演算の簡易化のような処理を、単純な処理の繰り返しで行えるようにしたもの。コンピュータでの処理に向いている。&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://ja.wikipedia.org/wiki/%E3%82%AF%E3%83%AF%E3%82%A4%E3%83%B3%E3%83%BB%E3%83%9E%E3%82%AF%E3%83%A9%E3%82%B9%E3%82%AD%E3%83%BC%E6%B3%95">クワイン・マクラスキー法 - Wikipedia&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://en.wikipedia.org/wiki/Petrick%27s_Method">Petrick&amp;rsquo;s method - Wikipedia&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>無名サブルーチンとクロージャ</title><link>https://maku.blog/p/r58xbyk/</link><pubDate>Wed, 30 Apr 2008 00:00:00 +0900</pubDate><guid>https://maku.blog/p/r58xbyk/</guid><description>&lt;p>『初めての Perl 第3版』より&lt;/p>
&lt;blockquote>
&lt;p>クロージャ (closure) は非常に強力な概念で、Lisp の世界から持ってきたものです。クロージャとは、（荒っぽい言い方をすれば）自分自身のプライベートなデータを持っている無名サブルーチンです。&lt;/p>
&lt;/blockquote>
&lt;p>『続・初めての Perl』より&lt;/p>
&lt;blockquote>
&lt;p>その時点で存在するすべてのレキシカル変数に、宣言された時点からアクセスできるサブルーチンをクロージャ (closure) と呼びます（クロージャは、もともとは数学用語です）。&lt;/p>
&lt;/blockquote>
&lt;p>例えば、以下の &lt;code>callback&lt;/code> サーブルーチンは、レキシカル変数 &lt;code>$count&lt;/code> を参照するクロージャといえます。&lt;/p>

&lt;figure class="xCodeBlock">

&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-perl" data-lang="perl">&lt;span class="line">&lt;span class="cl">&lt;span class="k">my&lt;/span> &lt;span class="nv">$count&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">sub&lt;/span> &lt;span class="nf">callback&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="o">++&lt;/span>&lt;span class="nv">$count&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure></description></item><item><title>大規模なコードを読み解くコツ（コードリーディング）</title><link>https://maku.blog/p/b34f2vu/</link><pubDate>Sat, 12 May 2007 00:00:00 +0900</pubDate><guid>https://maku.blog/p/b34f2vu/</guid><description>&lt;h2 id="階層構造の意味をメモする">階層構造の意味をメモする&lt;/h2>
&lt;p>大規模なプロジェクトのソースコードを読む場合は、まずはディレクトリがどのようなポリシーで分けられているのか、各ディレクトリ内のコードの役割などのメモを作成していくことをオススメします。&lt;/p>
&lt;p>役割のわからないディレクトリについては、そのままにしておいて、わかった時点で詳細を追加していけば OK です。&lt;/p>
&lt;pre tabindex="0">&lt;code>project
 +-- tools（ほげほげ用のツール）
 +-- src
 +-- hogeui（ほげほげインタフェースに関するクラス）
 +-- foobar（？）
&lt;/code>&lt;/pre></description></item><item><title>数値計算系のプログラムメモ</title><link>https://maku.blog/p/m3p8hh6/</link><pubDate>Sat, 20 Oct 2001 00:00:00 +0900</pubDate><guid>https://maku.blog/p/m3p8hh6/</guid><description>&lt;h2 id="n-が-2-のべき乗か判定する">n が 2 のべき乗か判定する&lt;/h2>

&lt;figure class="xCodeBlock">

&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">long&lt;/span> &lt;span class="nf">powerof2&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">long&lt;/span> &lt;span class="n">n&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">n&lt;/span> &lt;span class="o">&amp;gt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="n">n&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">n&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure></description></item></channel></rss>