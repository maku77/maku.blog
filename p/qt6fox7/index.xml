<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Linux のユーザー管理 on まくろぐ</title><link>https://maku.blog/p/qt6fox7/</link><description>Recent content in Linux のユーザー管理 on まくろぐ</description><generator>Hugo -- gohugo.io</generator><language>ja-jp</language><lastBuildDate>Fri, 05 Aug 2022 00:00:00 +0000</lastBuildDate><atom:link href="https://maku.blog/p/qt6fox7/index.xml" rel="self" type="application/rss+xml"/><item><title>Linuxメモ: ユーザーのデフォルトシェルを変更する (chsh)</title><link>https://maku.blog/p/cqaq7n4/</link><pubDate>Fri, 05 Aug 2022 00:00:00 +0000</pubDate><guid>https://maku.blog/p/cqaq7n4/</guid><description>ユーザーが Linux にログインしたときに起動するデフォルトシェルは、chsh (change login shell) コマンドで変更することができます。
カレントユーザーのログインシェルを /bin/bash に変更する $ chsh -s /bin/bash -s オプションではシェルのフルパスを指定する必要があることに注意してください。 例えば、Bash を使いたければ、bash ではなく /bin/bash と入力します。 -s オプションを省略すると、インタラクティブにシェルのパスを入力できます。
参考リンク Linux のユーザーを管理する (useradd, userdel, passwd) ユーザーを追加する (useradd) ときに、ついでにログインシェルを指定できます。 現在のシステムで選択可能なシェルの一覧は、/etc/shells ファイルで確認できます。
/etc/shells（Ubuntu 22.04 の場合） # /etc/shells: valid login shells /bin/sh /bin/bash /usr/bin/bash /bin/rbash /usr/bin/rbash /usr/bin/sh /bin/dash /usr/bin/dash /usr/bin/tmux /usr/bin/screen ユーザーごとのログインシェルが現在どう設定されているかは、/etc/passwd ファイルで確認できます。
$ cat /etc/passwd ...（省略）... maku:x:1000:1000::/home/maku:/bin/bash</description></item><item><title>Linuxメモ: sudo で管理者権限でコマンド実行できるようにする (/etc/sudoers, visudo)</title><link>https://maku.blog/p/h5v6gqz/</link><pubDate>Sun, 10 Jul 2022 00:00:00 +0000</pubDate><guid>https://maku.blog/p/h5v6gqz/</guid><description>sudo とは？ Linux の sudo コマンドは、一時的に root ユーザー（あるいは任意のユーザー）としてコマンドを実行できるようにするためのコマンドです。 システムの管理者的な立場の人であっても、常に root ユーザーとして作業するのはリスクがあるため、必要に応じて sudo でコマンド実行することが推奨されています。
sudo コマンドは、次のような形で実行します。
$ sudo ＜管理者権限が必要なコマンド＞ 例えば、/etc/shadow ファイルの閲覧は root ユーザーにしか許可されていませんが、カレントユーザーが sudoers（後述）に登録されていれば、次のようにして読み込むことができます。
$ sudo cat /etc/shadow [sudo] password for maku: （カレントユーザーのパスワードを入力） APT パッケージのインストールでも sudo はよく使われますね。
$ sudo apt install ansible [sudo] password for maku: （カレントユーザーのパスワードを入力） sudo 経由でコマンドを実行するときにパスワードの入力を求められますが、このとき入力するパスワードは root のものではなく、カレントユーザーのパスワードであることに注意してください（OpenSUSE の場合は例外的に root のパスワード）。 つまり、sudo は一般ユーザーが自分のパスワードで実行権限を切り替えてコマンドを実行する仕組みであり、sudoers の設定は慎重に行わなければいけません。
/etc/sudoers ファイルと visudo コマンド /etc/sudoers ファイル どのユーザーが、どのコマンドを、どのユーザーとして実行できるかを管理しているのが /etc/sudoers ファイルです。 ただし、このファイルは次のように編集ができないよう権限設定されており、直接エディタで開いて編集することはできません。
$ ls -l /etc/sudoers -r--r----- 1 root root 1671 Feb 8 17:41 /etc/sudoers visudo コマンド /etc/sudoers ファイルを編集するには、特別に用意された visudo コマンドを使用する必要があります。 次のように実行すれば、デフォルトエディタで /etc/sudoers ファイルを開くことができます。</description></item><item><title>Linuxメモ: Linux のユーザーを管理する (useradd, userdel, passwd)</title><link>https://maku.blog/p/7m5k3hx/</link><pubDate>Sat, 09 Jul 2022 00:00:00 +0000</pubDate><guid>https://maku.blog/p/7m5k3hx/</guid><description>Linux をインストールしたばかりの状態では、通常は特権ユーザーの root でログインできる状態になっています。 システム管理以外の日常的な作業には、useradd コマンドで作成した一般ユーザーを用います。
ユーザーを作成する (useradd) 新しいユーザーを作成するには、useradd コマンドを使用します。 -m オプションを指定することで、ユーザーのホームディレクトリを同時に作成することができます。
ユーザー maku を作成する # useradd maku （ユーザーを作成するだけ） # useradd -m maku （ホームディレクトリを同時に作成する） # useradd -m -s /bin/bash maku （さらに、ログインシェルを設定する） # useradd -m -s /bin/bash -G admin maku （さらに、admin グループに所属させる） オプションの意味 -m &amp;hellip; ユーザーのホームディレクトリを同時に作成します -s /bin/bash &amp;hellip; ログインシェルを /bin/bash に設定します。省略した場合は、/etc/default/useradd ファイルで定義されているシェルが設定されます（Ubuntu 22.04 の場合は /bin/sh ですが、dash へのシンボリックリンクです）。ユーザー生成後にログインシェルを変更したい場合は、chsh コマンド を使用します。 -G admin &amp;hellip; ユーザーを admin グループに所属させます（admin は Debian/Ubuntu で管理者を表すグループです）。グループの制御 はユーザー作成後にも行うことができます。 /etc/passwd ファイルを見ると、ユーザーが追加されていることを確認できます。 デフォルトでは、最初に作成したユーザーのユーザー ID は 1000 になります（その後追加するユーザーは、1001、1002、1003 となります）。</description></item><item><title>Linuxメモ: Linux のグループを管理する (groupadd, groupdel, gpasswd)</title><link>https://maku.blog/p/uexfvcs/</link><pubDate>Mon, 04 Jul 2022 00:00:00 +0000</pubDate><guid>https://maku.blog/p/uexfvcs/</guid><description>グループの作成と削除 (groupadd, groupdel) Linux でグループを作成／削除するには、groupadd および groupdel コマンドを使用します。 グループ作成時にグループ ID（数値）が自動的に割り当てられますが、-g オプションで明示することもできます。
グループ admin を作成する $ sudo groupadd admin # グループ ID は自動で割り当てる $ sudo groupadd -g 1234 admin # グループ ID を明示する グループ admin を削除する $ sudo groupdel admin ☝️ プライマリ・グループ useradd コマンドでユーザーを作成すると、デフォルトでそのユーザーは、ユーザー名と同じ名前のグループに所属することになります。 このグループをプライマリ・グループと呼びます。 例えば、useradd maku でユーザー maku を作成すると、同時に maku というプライマリ・グループが作成されます。 groupdel コマンドでプライマリ・グループを削除することはできません。 グループにユーザーを追加する (gpasswd) Linux のグループに既存のユーザーを追加／削除するには、gpasswd コマンドを使用します。
グループ admin にユーザー maku を追加する $ sudo gpasswd -a maku admin Adding user maku to group admin グループ admin からユーザー maku を削除する $ sudo gpasswd -d maku admin これらの設定を反映させるには、そのユーザーでログインし直す必要があります。</description></item></channel></rss>