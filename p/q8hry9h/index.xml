<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>MongoDB サーバー (mongod デーモン) on まくろぐ</title><link>https://maku.blog/p/q8hry9h/</link><description>Recent content in MongoDB サーバー (mongod デーモン) on まくろぐ</description><generator>Hugo</generator><language>ja-jp</language><lastBuildDate>Wed, 18 Jan 2023 00:00:00 +0900</lastBuildDate><atom:link href="https://maku.blog/p/q8hry9h/index.xml" rel="self" type="application/rss+xml"/><item><title>MongoDB サーバー (mongod) を起動する</title><link>https://maku.blog/p/3ucs8n3/</link><pubDate>Mon, 13 Apr 2015 00:00:00 +0900</pubDate><guid>https://maku.blog/p/3ucs8n3/</guid><description>&lt;p>MongoDB クライアント（&lt;code>mongo&lt;/code> コマンドや Web アプリケーション）から MongoDB のデータベースにアクセスするには、あらかじめ MongoDB サーバー（&lt;code>mongod&lt;/code>）を起動しておく必要があります。&lt;/p>
&lt;h2 id="mongodb-サーバーを起動する-mongod">MongoDB サーバーを起動する (mongod)&lt;/h2>
&lt;p>MongoDB サーバーは、単純にコマンドラインから &lt;strong>&lt;code>mongod&lt;/code>&lt;/strong> と実行するだけで起動できます（&lt;a href="../../p/tm4jzet">Windows のサービスとして起動&lt;/a> しておくことも可能です）。
&lt;code>mongod&lt;/code> コマンドを実行するときに、&lt;strong>&lt;code>--dbpath&lt;/code>&lt;/strong> オプションを使ってデータの格納先ディレクトリを指定することができます（デフォルトは &lt;strong>&lt;code>/data/db&lt;/code>&lt;/strong>）。
下記の例では、&lt;code>mydata&lt;/code> ディレクトリをデータ格納先に指定しています。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">MongoDB サーバーの起動&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> mkdir mydata
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> mongod --dbpath mydata
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;h2 id="ログファイル名を指定する---logpath---logappped">ログファイル名を指定する (--logpath, --logappped)&lt;/h2>
&lt;p>MongoDB サーバーのログはデフォルトで標準出力に出力されますが、&lt;strong>&lt;code>--logpath&lt;/code>&lt;/strong> オプションを使って、出力先のログファイル名を指定することもできます。
さらに、&lt;strong>&lt;code>--logappend&lt;/code>&lt;/strong> オプションを指定すると、これまでのログに追記される形で書き込まれます（このオプションを付けないと、ログファイルが上書きされてしまいます）。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">ログを log.txt に保存する&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> mongod --dbpath mydata --logpath log.txt --logappend
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>&lt;code>--dbpath&lt;/code> にはディレクトリ名を指定しますが、&lt;code>--logpath&lt;/code> にはファイル名を指定することに注意してください。&lt;/p>
&lt;h2 id="ポート番号を指定する---port">ポート番号を指定する (--port)&lt;/h2>
&lt;p>&lt;code>mongod&lt;/code> が使用するデフォルトのポート番号は &lt;strong>&lt;code>27017&lt;/code>&lt;/strong> ですが、&lt;strong>&lt;code>--port&lt;/code>&lt;/strong> オプションを使用して、任意のポート番号で起動することができます。
ポート番号を変更しておけば、1 台のホスト上で複数の &lt;code>mongod&lt;/code> を立ち上げることができます。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">ポート番号 40001 で起動する&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> mongod --dbpath mydata --port &lt;span class="m">40001&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>サーバー側のポート番号を変更した場合は、&lt;code>mongo&lt;/code> クライアントを起動するときにも &lt;code>mongo localhost:40001/dbname&lt;/code> や &lt;code>--port 40001&lt;/code> のようにポート番号の指定が必要になることに注意してください。&lt;/p></description></item><item><title>MongoDB サーバー (mongod) を Windows サービスとして登録する</title><link>https://maku.blog/p/tm4jzet/</link><pubDate>Fri, 17 Jan 2014 00:00:00 +0900</pubDate><guid>https://maku.blog/p/tm4jzet/</guid><description>&lt;h2 id="windows-サービスとして-mongodb-サービスを登録する">Windows サービスとして MongoDB サービスを登録する&lt;/h2>
&lt;p>MongoDB サーバー (&lt;code>mongod&lt;/code>) を Windows サービスとして登録しておくと、バックグラウンドで MongoDB サーバーが動作するようになるため、いちいちコマンドラインで &lt;code>mongod&lt;/code> を起動する必要がなくなります。&lt;/p>
&lt;p>MongoDB サーバーを Windows サービスとして登録するには、&lt;strong>コマンドプロンプトを管理者権限で起動&lt;/strong>し、次のように入力します。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">Windows サービスとして MongoDB サービスを登録&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">C:\&amp;gt; mongod --install --dbpath &amp;lt;DBディレクトリ&amp;gt; --logpath &amp;lt;ログファイル名&amp;gt;&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>コンソール上でログを確認することができなくなってしまうので、ログがファイルに保存されるように、ログファイル名を指定しておく必要があります。&lt;/p>
&lt;p>下記は実行例です。
ここでは、データベースディレクトリとして &lt;code>D:\mongo_data&lt;/code>、ログファイル名 &lt;code>D:\mongo_log\log.txt&lt;/code> を指定しています。
ディレクトリはあらかじめ作成しておく必要があります。&lt;/p>

&lt;figure class="xCodeBlock">

&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">C:\&amp;gt; mkdir D:\mongo_data
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">C:\&amp;gt; mkdir D:\mongo_log
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">C:\&amp;gt; mongod --install --dbpath D:\mongo_data --logpath D:\mongo_log\log.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Fri Jan 17 12:11:49.699 Trying to install Windows service &amp;#39;MongoDB&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Fri Jan 17 12:11:49.711 Service &amp;#39;MongoDB&amp;#39; (Mongo DB) installed with command line &amp;#39;C:\app\mongodb\mongod.exe --dbpath D:\mongo_data --logpath D:\mongo_log\log.txt --service&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Fri Jan 17 12:11:49.712 Service can be started from the command line with &amp;#39;net start MongoDB&amp;#39;&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>これで、&lt;strong>&lt;code>MongoDB&lt;/code>&lt;/strong> という名前の Windows サービスとして認識されるようになります。
&lt;code>sc&lt;/code> コマンドで、実際に登録されているか確認しておきましょう。&lt;/p></description></item><item><title>Docker で MongoDB サーバーを立ち上げる</title><link>https://maku.blog/p/y6zgrg2/</link><pubDate>Wed, 18 Jan 2023 00:00:00 +0900</pubDate><guid>https://maku.blog/p/y6zgrg2/</guid><description>&lt;p>Docker のオフィシャルイメージとして、&lt;strong>&lt;code>mongo&lt;/code>&lt;/strong> イメージが公開されています。&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://hub.docker.com/_/mongo">mongo - Official Image | Docker Hub&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>このイメージには、MongoDB サーバー (&lt;code>mongod&lt;/code>) や、MongoDB クライアント (&lt;code>mongosh&lt;/code>) が含まれており、コマンドを省略してコンテナを起動すると、デフォルトで MongoDB サーバーが立ち上がります。&lt;/p>
&lt;h2 id="mongodb-サーバーのコンテナを起動する">MongoDB サーバーのコンテナを起動する&lt;/h2>
&lt;p>次のように &lt;code>mongo&lt;/code> コンテナを起動すると、ローカルホスト上で MongoDB サーバーを立ち上げたのと同様に振舞います。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-console" data-lang="console">&lt;span class="line">&lt;span class="cl">&lt;span class="gp">$&lt;/span> docker container run --rm -d -p 27017:27017 --name mongo mongo
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>オプションの意味:&lt;/p>
&lt;ul>
&lt;li>&lt;strong>&lt;code>--rm&lt;/code>&lt;/strong> &amp;hellip; コンテナを停止したときにコンテナを削除します。コンテナを削除したくなければ、このオプションは外してください。&lt;/li>
&lt;li>&lt;strong>&lt;code>-d&lt;/code>&lt;/strong> &amp;hellip; デーモンをバックグラウンドで動作させます。&lt;/li>
&lt;li>&lt;strong>&lt;code>-p 27107:27017&lt;/code>&lt;/strong> &amp;hellip; ローカルホストの &lt;code>27107&lt;/code> ポートへのアクセスを、コンテナ内の MongoDB サーバーの &lt;code>27107&lt;/code> ポートへ転送します。&lt;/li>
&lt;li>&lt;strong>&lt;code>--name mongo&lt;/code>&lt;/strong> &amp;hellip; 起動するコンテナに &lt;code>mongo&lt;/code> という名前を付けます。&lt;/li>
&lt;li>&lt;strong>&lt;code>mongo&lt;/code>&lt;/strong> &amp;hellip; Docker イメージとして &lt;code>mongo:latest&lt;/code> を使用します（デフォルトで &lt;code>:latest&lt;/code> が使われます)。&lt;/li>
&lt;/ul>
&lt;p>次のようにして、&lt;code>mongo&lt;/code> コンテナが起動していることを確認できます。&lt;/p></description></item></channel></rss>