---
title: "Excel 関数のメモ"
url: "/p/hewor72"
date: "2018-04-16"
tags: ["Excel"]
---

文字列を繰り返す (REPT) <!-- 2010-11-12 -->
----

{{< code title="書式" >}}
=REPT(文字列, 繰り返し回数)
{{< /code >}}

{{< code title="例: A1 セルに記述した数だけ `*` を表示する" >}}
=REPT("*",A1)
{{< /code >}}

これを利用すれば、文字を使用した簡易的なヒストグラムを表示することができます。


日付から年/月/日/曜日など一部の情報を取得する
----

下記の表は、A1 セルに 2018-04-02（月） という日付データが入力されている場合に、各式の評価結果がどのようになるかを示しています。

| 式 | 結果 | 説明 |
| ---- | ---- | ---- |
| `=TEXT(A1,"m月")` | 4月 | 書式指定で月を取得 |
| `=TEXT(A1,"aaa")` | 月 | 書式指定で曜日を取得 |
| `=TEXT(A1, "aaaa")` | 月曜日 | 書式指定で曜日を取得（"aaa曜日" でも同じ） |
| `=YEAR(A1)` | 2018 | 数値で年（4桁）を取得 |
| `=MONTH(A1)` | 4 | 数値で月 (1～12) を取得 |
| `=DAY(A1)` | 2 | 数値で日 (1～31） を取得 |
| `=WEEKDAY(A1)` | 2 | 数値で曜日 (1～7) を取得（日曜日が1） |
| `=WEEKNUM(A1)` | 14 | その年の第何週目か |


現在の日時を表示する
----

| 式 | 結果 | 説明 |
| ---- | ---- | ---- |
| `=TODAY()` | 2018/4/2 | 今日の日付 |
| `=NOW()` | 2018/4/2 9:24PM | 現在時刻 ※表示形式を時刻にすると時刻部分が表示されます |
| `=NOW()-0.5` | 2018/4/2 9:24AM | 12時間前の時刻asdofij |


日付文字列から日付データに変換
----

{{< code >}}
=DATEVALUE("2018-04-02")
{{< /code >}}

`DATEVALUE` 関数は、日付文字列を、日付のシリアル値（内部的には 43192 といった数値）に変換します。
変換後の値を「年月日」のような形で正しく表示するには、セルの書式形式で「日付」や「時刻」を選択しておく必要があります。


月末の日付を調べるテクニック
----

月末の日付は、「翌月の1日前」を計算することで取得することができます。
今、`A1` セルに 4月2日を表す日付データが含まれているとすると、下記の式は、4月30日を示す日付データとなります。

{{< code >}}
=DATE(YEAR(A1), MONTH(A1)+1, 0)
{{< /code >}}

`DATE` 関数の最後のパラメータは「日」を設定するのですが、ここで 0 と入力することで、1 日前を示すことができます。

