---
title: "Amazon EC2 で Hello World (1) キーペアの作成"
url: "/p/pcp3doy"
date: "2021-03-02"
tags: ["AWS"]
weight: 101
---

EC2 を使う前に SSH キーペアを作成しておく
----

立ち上げた EC2 インスタンスは SSH で接続して操作するため、まずはキーペア（公開鍵＋秘密鍵）を作成して、その公開鍵を EC2 に登録しておく必要があります。
一度公開鍵を登録すると、EC2 インスタンスを作成するときに、割り当てる公開鍵をプルダウンから選択できるようになります。


EC2 コンソールからキーペアを作成する
----

SSH 接続用のキーペアは、ローカルで作成して EC2 に登録することもできますし、EC2 コンソール上で新規作成することもできます。
EC2 上で作成すると、公開鍵が自動的に EC2 に登録された状態になるのでちょっとだけ楽です。
ここでは、次のように EC2 上でキーペアを作成します。

1. [EC2 マネージメントコンソール](https://console.aws.amazon.com/ec2/v2/home) を開く
1. サイドバーから __`キーペア`__ を選択し、__`キーペアを作成`__ をクリック
1. キーペアの作成画面で名前とファイル形式を入力し、__`キーペアを作成`__ をクリック
    - 名前: __`ec2key`__ など自由に入力
    - ファイル形式:（使用する SSH クライアントに合わせて選択）
        - `pem` 形式 ... OpenSSH を使う場合（主に Linux/macOS）
        - `ppk` 形式 ... PuTTY を使う場合（主に Windows）

すると、自動的に `ec2key.pem`（秘密鍵）のダウンロードが始まるので、`~/.ssh` ディレクトリなどに確実に保存します。
この __キーファイルを再度ダウンロードすることはできないので注意してください__。

EC2 コンソール上に次のように表示されていれば、今後 EC2 インスタンスを生成するときにこのキーを選択できます。

{{< image border="true" src="img-001.png" >}}


秘密鍵ファイルのパーミッションを設定する
----

ローカル PC に保存した秘密鍵ファイル (`.pem`) には、自分だけを読み取り可能にするよう、適切なパーミッションを設定しておく必要があります。
これをやっておかないと、`ssh` コマンドを実行するときに、`WARNING: UNPROTECTED PRIVATE KEY FILE!` といった警告が出て接続ができません。

{{< code >}}
$ chmod 0400 ~/.ssh/ec2key.pem
{{< /code >}}

これで、EC2 インスタンスに接続するためのキーペアの準備は完了です。

次のステップ → [Amazon EC2 で Hello World (2) EC2 インスタンスの起動と接続](/p/whu7hr3)

