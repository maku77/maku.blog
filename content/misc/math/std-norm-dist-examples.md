---
title: "数学メモ: 標準正規分布を使った計算問題の例"
url: "p/zfgia97/"
date: "2024-09-25"
tags: ["数学"]
useMath: true
---

統計のお勉強です。
[標準正規分布の上側確率](/p/3ukihbq/) の表を作ったので、それを使った問題に慣れます。

\\( \lt \\) と \\( \leq \\) の差（\\( \gt \\) と \\( \geq \\) の差）は微々たるものなので、ここでは気にしないことにします。


確率変数 \\( X \\) が標準正規分布に従うとき
----

### 問題: 確率 \\( P(X \gt 2) \\) を求めよ

確率変数 \\( X \\) が標準正規分布に従うとき、つまり \\( X \sim N(0, 1) \\) のとき、確率 \\( P(X \gt 2) \\) は、標準正規分布の上側確率の表の 2.00 のところを見るだけで OK です。
上側確率は 0.0228 となっているので、

$$
P(X \gt 2) = 0.0228
$$

が答えです。

{{< note title="正規分布の表現" >}}
正規分布のグラフの形状は平均と分散の 2 変数だけで決まります。
平均が \\( \mu \\)、分散が \\( \sigma^2 \\) の正規分布は一般的に __\\( N(\mu, \sigma^2) \\)__ のように表現されます。
標準正規分布は平均が 0 で分散が 1 の正規分布なので __\\( N(0, 1) \\)__ です。
確率変数 \\( X \\) が標準正規分布に従う場合、__\\( X \sim N(0, 1) \\)__ と表現します（複数の確率変数 \\( X_i \\) がある場合は、\\( X_i \sim N(0, 1) \\) と表現されることもあります）。
{{< /note >}}

### 問題: 確率 \\( P(X \lt -2) \\) を求めよ

正規分布のグラフは左右対称なので、下側確率 \\( P(X \lt -2) \\) は上側確率 \\( P(X \gt 2) \\) と等しくなります。
よって、上側確率の表だけあれば求められます。

$$
\begin{align}
P(X \lt -2) &= P(X \gt 2) \\\\
  &= 0.0228
\end{align}
$$

### 問題: 確率 \\( P(-2 \lt X \lt 2) \\) を求めよ

全体の確率 1 から、上側確立 \\( P(X \gt 2) \\) と下側確率 \\( P(X \lt -2) \\) を引くことで求められます。

$$
\begin{align}
P(-2 \lt X \lt 2) &= 1 - P(X \gt 2) - P(X \lt -2) \\\\
  &= 1 - 2 P(X \gt 2) \\\\
  &= 1 - 2 \times 0.0228 \\\\
  &= 0.9544
\end{align}
$$


確率変数 \\( X \\) が期待値 1、分散 9 の正規分布に従うとき
----

確率変数における「期待値」は「平均値」と考えてしまえばよいです。
この問題の分布は \\( X \sim N(1, 3^2) \\) ですが、これをどのように標準正規分布の上側確率の問題に落とし込むかがポイントです。

### 問題: 確率 \\( P(X > 2) \\) を求めよ

確率変数 \\( X \\) は正規分布には従いますが、平均 0、分散 1 ではないので、そのままでは標準正規分布の上側確率の表が使えません。
そこで、以下のように標準化した確率変数 \\( Z \\) を作ります（平均を引いて標準偏差で割ります）。

$$
\begin{align}
Z &= \frac{X - \mu}{\sigma} \\\\
  &= \frac{X - 1}{3}
\end{align}
$$

すると、この確率変数 \\( Z \\) は平均 0、分散 1 の標準正規分布に従います（\\( Z \sim N(0, 1) \\)）。
よって、\\( P(X \gt ◯) \\) という形の問題を \\( P(Z \gt ●) \\) という形に変換できれば、標準正規分布の上側確率の表を使って答えを求めることができます。

上の変換式から、\\( X = 3Z + 1 \\) なので、これを元々の問題である \\( P(X \gt 2) \\) の \\( X \\) に代入します。

$$
\begin{align}
P(X \gt 2) &= P(3Z + 1 \gt 2) \\\\
  &= P(3Z \gt 1) \\\\
  &= P(Z \gt 1/3) \\\\
\end{align}
$$

よって、標準正規分布の上側確率の 0.33 の部分を参照すればよく、答えは 0.3707 です。

次のように、元々の式全体を一気に標準化してしまう方法もあります。
やってることは同じですが、慣れるとこちらの方が速いです。

$$
\begin{align}
P(X \gt 2) &= P(\frac{X - 1}{3} \gt \frac{2 - 1}{3}) \\\\
  &= P(Z \gt \frac{2 - 1}{3}) \\\\
  &= P(Z \gt 1/3) \\\\
  &= 0.3707
\end{align}
$$

### 問題: 確率 \\( P(-1 \lt X \lt 2) \\) を求めよ

同様に、平均（期待値）1 と標準偏差 3 による標準化を行って \\( P(Z \gt ●) \\) の形に変換すれば OK です。

$$
\begin{align}
P(-1 \lt X \lt 2) &= P(\frac{-1 - 1}{3} \lt \frac{X - 1}{3} \lt \frac{2 - 1}{3}) \\\\
  &= P(\frac{-1 - 1}{3} \lt Z \lt \frac{2 - 1}{3}) \\\\
  &= P(-\frac{2}{3} \lt Z \lt \frac{1}{3}) \\\\
  &= 1 - P(Z > \frac{2}{3}) - P(Z > \frac{1}{3}) \\\\
  &= 1 - 0.2514 - 0.3707 \\\\
  &= 0.3779
\end{align}
$$


（応用）合計値の平均と分散
----

### 問題: 9800 ポンドの荷物を運べるエレベーターで、49 個の貨物を運ばなければいけないとします。貨物 1 つあたりの重さは、平均 (\\( \mu \\)) 205 ポンド、標準偏差 (\\( \sigma \\)) 15 ポンドの正規分布に従います。すべての貨物を安全に運べる確率を求めてください。

- 出典: [HackerRank - Day 4: The Central Limit Theorem #1](https://www.hackerrank.com/challenges/the-central-limit-theorem-1/problem?isFullScreen=true)

すべての荷物の重さの合計を \\( T \\) とおくと、この問題は確率 \\( P(T \leq 9800) \\) を求めよという問題です。
これも、\\( T \\) の分布を標準化して、\\( P(Z \gt ●) \\) の問題に書き換えられれば解決です。

標準化のためには、まずは \\( T \\) がどのような正規分布なのかが分からなければいけません。
貨物 1 つ当たりの重さの平均（期待値）が 205、標準偏差が 15 ということなので、それを 49 個集めた合計 \\( T \\) の平均は \\( 10045 (= 205 \cdot 49) \\)、標準偏差は \\( 105 (= \sqrt{49} \cdot 15) \\) になります。
つまり、\\( T \\) の分布は \\( T \sim N(10045, 105^2) \\) と書けます。

{{% note title="合計値の平均と分散は n 倍になる" %}}
確率変数 \\( X \\) が平均 \\( \mu \\)、分散 \\( \sigma^2 \\) の正規分布に従うとき（\\( X \sim N(\mu, \sigma^2) \\)）、それを \\( n \\) 個集めた合計 \\( T \\) の分布は、平均と分散がそれぞれ \\( n \\) 倍になります（__\\( T \sim N(n \cdot \mu, n \cdot \sigma^2) \\)__）。
平均も分散も項の和の形で計算するものなので、その数が \\( n \\) 倍になれば、平均も分散も単純に \\( n \\) 倍になります。
ちなみに、標準偏差は \\( \sqrt{n} \\) 倍の \\( \sqrt{n} \cdot \sigma \\) になります。
{{% /note %}}

確率変数 \\( T \\) の分布形状が分かったので、あとは問題とされている \\( P(T \leq 9800) \\) を標準化していくだけです。

$$
\begin{align}
P(T \leq 9800) &= P(\frac{T - 10045}{105} \leq \frac{9800 - 10045}{105}) \\\\
  &= P(Z \leq \frac{9800 - 10045}{105}) \\\\
  &= P(Z \leq -2.333) \\\\
  &= P(Z \geq 2.333) \\\\
  &= 0.0099
\end{align}
$$

### 問題: 一人あたりのチケット購入枚数が、平均 \\( \mu = 2.4 \\) 枚、標準偏差 \\( \sigma = 2.0 \\) 枚の正規分布に従うとします。チケットの残りが 250 枚のとき、100 人が購入できる確率を求めてください。

- 出展: [HackerRank - Day 4: The Central Limit Theorem #2](https://www.hackerrank.com/challenges/the-central-limit-theorem-2/problem?isFullScreen=true)

合計購入枚数を確率変数 \\( T \\) とおくと、この問題は確率 \\( P(T \leq 250) \\) を求めよという問題です。
これを標準化して \\( P(Z \geq ●) \\) の形に持っていければゲームクリアです。

まず、確率変数 \\( T \\) がどのような正規分布なのかを考えます。
問題文より、1 人当たりの購入枚数を \\( X \\) とおくと、\\( X \sim N(2.4, 2.0^2) \\) です。
100 人の合計枚数 \\( T \\) では、\\( T \sim N(100 \cdot 2.4, (10 \cdot 2.0)^2) \\) になります （平均が 100 倍、標準偏差が 10 倍）。

確率変数 \\( T \\) の分布形状が分かった (\\( \mu = 240, \sigma = 20 \\)) ので、あとは標準化していきます。

$$
\begin{align}
P(T \leq 250) &= P(\frac{T - 240}{20} \leq \frac{250 - 240}{20}) \\\\
  &= P(Z \leq \frac{250 - 240}{20}) \\\\
  &= P(Z \leq 0.5) \\\\
  &= 1 - P(Z \gt 0.5) \\\\
  &= 1 - 0.3085 \\\\
  &= 0.6915
\end{align}
$$

### 問題: 母集団（平均 \\( \mu = 500 \\) 、標準偏差 \\( \sigma = 80 \\)）から 100 個のサンプルを抽出したとき、サンプルの平均値が (490, 510) の範囲に入る確率を求めてください。

- 出典: [HackerRank - The Central Limit Theorem #3](https://www.hackerrank.com/challenges/the-central-limit-theorem-3/problem?isFullScreen=true)

この問題は、合計値の分布ではなく、標本平均の分布に関する問題です。
標本平均を \\( \bar{X} \\) とすると、\\( P(490 \lt \bar{X} \lt 510) \\) を求めよという問題です。
なので、標本平均の分布がどのような正規分布になるかが分かればクリアです。

正規分布 \\( N(\mu, \sigma^2) \\) に従う母集団から n 個のサンプルを抽出して標本平均を取ると、標本平均は \\( N(\mu, \frac{\sigma^2}{n}) \\) の正規分布に従います。
平均は同じで、分散が \\( \frac{1}{n} \\)（標準偏差は \\( \frac{1}{\sqrt{n}} \\)）に減少するということですね（証明は省略）。

今回のケースでは、標本平均の分布は平均 が \\( \mu = 500 \\) のままで、標準偏差が \\( \sigma = \frac{80}{\sqrt{100}} = 8 \\) の正規分布に従うことになります (\\( \bar{X} \sim N(500, 8^2) \\))。
分布が分かったので、あとは標準化していきます。

$$
\begin{align}
P(490 \lt \bar{X} \lt 510)
  &= P(\frac{490 - 500}{8} \lt \frac{\bar{X} - 500}{8} \lt \frac{510 - 500}{8}) \\\\
  &= P(-\frac{10}{8} \lt Z \lt \frac{10}{8}) \\\\
  &= P(-1.25 \lt Z \lt 1.25) \\\\
  &= 1 - 2 \cdot P(Z \geq 1.25) \\\\
  &= 1 - 2 \cdot 0.1056 \\\\
  &= 0.7888
\end{align}
$$

