---
title: "数学メモ: 標準正規分布を使った計算問題の例"
url: "p/zfgia97/"
date: "2024-09-25"
tags: ["数学"]
useMath: true
draft: true
---

統計のお勉強です。
[標準正規分布の上側確率](/p/3ukihbq/) の表を作ったので、それを使った問題に慣れます。

\\( \lt \\) と \\( \leq \\) の差（\\( \gt \\) と \\( \geq \\) の差）は微々たるものなので、ここでは気にしないことにします。


確率変数 \\( X \\) が標準正規分布に従うとき
----

### 問題: 確率 \\( P(X \gt 2) \\) を求めよ

確率変数 \\( X \\) が標準正規分布に従うとき、つまり \\( X \sim N(0, 1) \\) のとき、確率 \\( P(X \gt 2) \\) は、標準正規分布の上側確率の表の 2.00 のところを見るだけで OK です。
上側確率は 0.0228 となっているので、

$$
P(X \gt 2) = 0.0228
$$

が答えです。

{{< note title="正規分布の表現" >}}
正規分布のグラフの形状は平均と分散の 2 変数だけで決まります。
平均が \\( \mu \\)、分散が \\( \sigma^2 \\) の正規分布は一般的に __\\( N(\mu, \sigma^2) \\)__ のように表現されます。
標準正規分布は平均が 0 で分散が 1 の正規分布なので __\\( N(0, 1) \\)__ です。
確率変数 \\( X \\) が標準正規分布に従う場合、__\\( X \sim N(0, 1) \\)__ と表現します（複数の確率変数 \\( X_i \\) がある場合は、\\( X_i \sim N(0, 1) \\) と表現されることもあります）。
{{< /note >}}

### 問題: 確率 \\( P(X \lt -2) \\) を求めよ

正規分布のグラフは左右対称なので、下側確率 \\( P(X \lt -2) \\) は上側確率 \\( P(X \gt 2) \\) と等しくなります。
よって、上側確率の表だけあれば求められます。

$$
\begin{align}
P(X \lt -2) &= P(X \gt 2) \\\\
  &= 0.0228
\end{align}
$$

### 問題: 確率 \\( P(-2 \lt X \lt 2) \\) を求めよ

全体の確率 1 から、上側確立 \\( P(X \gt 2) \\) と下側確率 \\( P(X \lt -2) \\) を引くことで求められます。

$$
\begin{align}
P(-2 \lt X \lt 2) &= 1 - P(X \gt 2) - P(X \lt -2) \\\\
  &= 1 - 2 P(X \gt 2) \\\\
  &= 1 - 2 \times 0.0228 \\\\
  &= 0.9544
\end{align}
$$


確率変数 \\( X \\) が期待値 1、分散 9 の正規分布に従うとき
----

確率変数における「期待値」は「平均値」と考えてしまえばよいです。
この問題の分布は \\( X \sim N(1, 3^2) \\) ですが、これをどのように標準正規分布の上側確率の問題に落とし込むかがポイントです。

### 問題: 確率 \\( P(X > 2) \\) を求めよ

確率変数 \\( X \\) は正規分布には従いますが、平均 0、分散 1 ではないので、そのままでは標準正規分布の上側確率の表が使えません。
そこで、以下のように標準化した確率変数 \\( Z \\) を作ります（平均を引いて標準偏差で割ります）。

$$
\begin{align}
Z &= \frac{X - \mu}{\sigma} \\\\
  &= \frac{X - 1}{3}
\end{align}
$$

すると、この確率変数 \\( Z \\) は平均 0、分散 1 の標準正規分布に従います（\\( Z \sim N(0, 1) \\)）。
よって、\\( P(X \gt ◯) \\) という形の問題を \\( P(Z \gt ●) \\) という形に変換できれば、標準正規分布の上側確率の表を使って答えを求めることができます。

上の変換式から、\\( X = 3Z + 1 \\) なので、これを元々の問題である \\( P(X \gt 2) \\) の \\( X \\) に代入します。

$$
\begin{align}
P(X \gt 2) &= P(3Z + 1 \gt 2) \\\\
  &= P(3Z \gt 1) \\\\
  &= P(Z \gt 1/3) \\\\
\end{align}
$$

よって、標準正規分布の上側確率の 0.33 の部分を参照すればよく、答えは 0.3707 です。

次のように、元々の式全体を一気に標準化してしまう方法もあります。
やってることは同じですが、慣れるとこちらの方が速いです。

$$
\begin{align}
P(X \gt 2) &= P(\frac{X - 1}{3} \gt \frac{2 - 1}{3}) \\\\
  &= P(Z \gt \frac{2 - 1}{3}) \\\\
  &= P(Z \gt 1/3) \\\\
  &= 0.3707
\end{align}
$$

### 問題: 確率 \\( P(-1 \lt X \lt 2) \\) を求めよ

同様に、平均（期待値）1 と標準偏差 3 による標準化を行って \\( P(Z \gt ●) \\) の形に変換すれば OK です。

$$
\begin{align}
P(-1 \lt X \lt 2) &= P(\frac{-1 - 1}{3} \lt \frac{X - 1}{3} \lt \frac{2 - 1}{3}) \\\\
  &= P(\frac{-1 - 1}{3} \lt Z \lt \frac{2 - 1}{3}) \\\\
  &= P(-\frac{2}{3} \lt Z \lt \frac{1}{3}) \\\\
  &= 1 - P(Z > \frac{2}{3}) - P(Z > \frac{1}{3}) \\\\
  &= 1 - 0.2514 - 0.3707 \\\\
  &= 0.3779
\end{align}
$$


（応用）合計値の平均と分散
----

### 問題: 9800 ポンドの荷物を運べるエレベーターで、49 個の貨物を運ばなければいけないとします。貨物 1 つあたりの重さは、平均 (\\( \mu \\)) 205 ポンド、標準偏差 (\\( \sigma \\)) 15 ポンドの正規分布に従います。すべての貨物を安全に運べる確率を求めてください。

- 出典: [HackerRank - Day 4: The Central Limit Theorem #1](https://www.hackerrank.com/challenges/the-central-limit-theorem-1/problem?isFullScreen=true)

すべての荷物の重さの合計を \\( T \\) とおくと、この問題は確率 \\( P(T \leq 9800) \\) を求めよという問題です。

確率変数 \\( X \\) が \\( N(\mu, \sigma^2) \\) に従うとき、それを n 個集めたときの分布

n 個の貨物の重さの合計を \\( T \\) とすると、その分布は、平均が \\( n \cdot \mu \\)、分散が \\( n \cdot \sigma^2 \\)（標準偏差は \\( \sqrt{n} \cdot \sigma \\)） の正規分布になります。
つまり、今回の問題設定では、

