---
title: "エミュレーター: FCEUX で TAS 動画を作る"
linkTitle: "FCEUX で TAS 動画を作る"
url: "/p/ys8myer"
date: "2021-11-22"
tags: ["エミュレーター"]
---

ファミコンのプレイ動画を作る機会があったので、その操作手順をメモメモ。
いわゆる TAS (Tool-Assisted Superplay) と呼ばれているもので、うまくプレイできたものだけを繋げた動画を作ります。

今回使うのはファミコンのエミュレーター [FCEUX](https://fceux.com/web/home.html) で、ムービーの保存機能がついています（実際には各フレームの操作内容を記録しているだけ）。
これとセーブ機能を組み合わせて、何度もプレイをやり直すことで、ノーミスプレイの動画を作ることができます。


録画手順
----

ゲームの ROM をロードした状態で、メニューから __`Movie`__ → __`Movie Record`__ と選択すると録画（操作内容の記録）を開始できます。

このとき、`Record` の項目で `Start` を選択しておくと、ゲームがリセットされたところから操作の記録が開始されるので、普通にゲームを進めていきます。

録画を終了したいときは、メニューから __`Movie Stop`__ を選択します。
FCEUX の場合、プレイ内容は `.fm2` という拡張子の Movie ファイルとして保存されます。


プレイのやり直し（録画内容の上書き）
----

スロット（0〜9）を使ったステートのセーブ＆ロード機能を使うと、任意の地点からプレイをやり直すことができます。

- `Shift` + `F1〜F10` ... スロット 0〜9 へのセーブ
- `F1〜F10` ... スロット 0〜9 からロード

このロード機能は `Movie Record` による録画にも反映されるため、適宜 `Shift+F1` でセーブしつつ、`F1` でロードすることによって、うまくいったプレイだけの Movie ファイルを作ることができます。

次のようにすると、既存の Movie ファイル (`.fm2`) を再生して、途中から操作をやり直し（記録内容を上書き）することができます。
Movie ファイルを上書きするときは、ファイルをバックアップしておくと安心です。

1. メニューから `Movie` → `Movie Play` を選択
1. `Open Read-Only` のチェックを外す
1. `Play` ボタンで Movie ファイルを再生開始
1. 早送りキー（後述）などでやり直したいところまで進めて、`Shift+F1` などでステートセーブ
1. `F1` キーでステートロードすると、その地点からの録画が開始される

あとは、納得のいくプレイができるまでステートセーブ＆ロードを繰り返すだけです。


動画ファイルに出力する
----

上記手順で作成した `.fm2` ファイルは、あくまでエミュレーター上で再生できる操作データであって、YouTube で見れるような動画ファイルではありません。
安心してください。FCEUX には、動画ファイルを作成する機能もついています。

1. メニューから `Movie` → `AVI Record As` を選択
1. ファイル名を入力して `Save` ボタンを押す

これで、現在のプレイ内容が動画ファイルへの出力されていきます。
このとき、描画スピードを上げても動画ファイルの内容は正しいスピードのもので作成されるので大丈夫です。

デフォルトのエンコーダー設定だと、若干映像が荒かったりするので、`Options` → `Movie Options` で設定を変えると綺麗になったりします（例えば、AVI Backend driver というところを `libgwavi` に変えて、エンコーダーに H.264 を選ぶという方法があります）。


（おまけ）キーコンフィグ
----

FCEUX のメニューから、__`Options`__ → __`HotKey Config`__ を選択すると、キーボードで各種操作を行うためのホットキーを設定できます。
フレームのポーズ機能や、再生速度を制御するためのホットキーを、自分が押しやすいキーに変更しておくと便利です。

- Emulation / Pause ... フレームのポーズ機能（デフォルトが `Pause` キーなので、`Space` などにしておくと押しやすい）
- Speed / DecreaseSpeed ... フレームの再生速度を下げる（デフォルトの `-` でも OK）
- Speed / IncreaseSpeed ... フレームの再生速度を上げる（デフォルトの `=` でも OK）

