<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>D3.js on まくろぐ</title><link>https://maku.blog/tags/d3js/</link><description>Recent content in D3.js on まくろぐ</description><generator>Hugo</generator><language>ja-jp</language><lastBuildDate>Sun, 14 Jan 2024 00:00:00 +0900</lastBuildDate><atom:link href="https://maku.blog/tags/d3js/index.xml" rel="self" type="application/rss+xml"/><item><title>D3.js で円グラフを描画する (d3.pie)</title><link>https://maku.blog/p/v3g55wz/</link><pubDate>Thu, 30 Nov 2023 00:00:00 +0900</pubDate><guid>https://maku.blog/p/v3g55wz/</guid><description>&lt;p>D3.js を使って円グラフを描画するには、&lt;code>d3.pie()&lt;/code> と &lt;code>d3.arc()&lt;/code> を組み合わせて使用します。&lt;/p>
&lt;h2 id="d3pie-関数で扇形の角度を計算する">d3.pie() 関数で扇形の角度を計算する&lt;/h2>
&lt;p>D3.js の &lt;strong>&lt;code>d3.pie()&lt;/code>&lt;/strong> 関数を使うと、円グラフ (pie chart) やドーナツチャート (donut chart) を描画するための &lt;strong>角度を計算する関数オブジェクトを生成&lt;/strong> できます。
生成した関数にデータ配列を渡すと、各データに対応する扇形部分の開始角度 (&lt;code>startAngle&lt;/code>) と終了角度 (&lt;code>endAngle&lt;/code>) を計算してくれます。
角度はラジアンで表現されるので、180° は 3.1415 になります。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-js" data-lang="js">&lt;span class="line">&lt;span class="cl">&lt;span class="kr">const&lt;/span> &lt;span class="nx">data&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="c1">// 任意のデータ配列
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kr">const&lt;/span> &lt;span class="nx">pie&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nx">d3&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">pie&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="c1">// pie 関数の生成
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kr">const&lt;/span> &lt;span class="nx">arcs&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nx">pie&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">data&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// データ配列に角度情報を付加する
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">console&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">args&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-json" data-lang="json">&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;data&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nt">&amp;#34;index&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nt">&amp;#34;value&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nt">&amp;#34;startAngle&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;endAngle&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mf">3.141592653589793&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nt">&amp;#34;padAngle&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;data&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nt">&amp;#34;index&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nt">&amp;#34;value&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nt">&amp;#34;startAngle&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mf">3.141592653589793&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;endAngle&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mf">5.026548245743669&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nt">&amp;#34;padAngle&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;data&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nt">&amp;#34;index&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nt">&amp;#34;value&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nt">&amp;#34;startAngle&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mf">5.026548245743669&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;endAngle&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mf">6.283185307179586&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nt">&amp;#34;padAngle&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>任意のデータ配列を &lt;code>pie()&lt;/code> 関数に渡すと、上記のように &lt;code>startAngle&lt;/code>、&lt;code>endAngle&lt;/code> といった角度情報付きデータ配列を返してくれます。
元のデータ配列の各要素は &lt;code>data&lt;/code> プロパティに格納されているので、これ以降は元のデータ配列の代わりにこの角度情報付きのデータ配列だけを使えばよいことになります（例えば、D3.js のコンポーネントの &lt;code>data()&lt;/code> メソッドにはこの配列を渡せばよい）。&lt;/p>
&lt;div class="xNote">
 &lt;span class="xNote_title">☝️ TypeScript を使う場合&lt;/span>
 &lt;span class="xNote_body">&lt;p>TypeScript を使って、&lt;code>pie()&lt;/code> 関数に渡すデータ配列の型を指定するには次のようにします。
配列型ではなく、個々の要素の型を指定することに注意してください。
単一のデータであることを強調するために、data の単数系である datum という単語を使っています。&lt;/p></description></item></channel></rss>