<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>SVG on まくろぐ</title><link>https://maku.blog/tags/svg/</link><description>Recent content in SVG on まくろぐ</description><generator>Hugo -- gohugo.io</generator><language>ja-jp</language><lastBuildDate>Wed, 01 Nov 2023 00:00:00 +0000</lastBuildDate><atom:link href="https://maku.blog/tags/svg/index.xml" rel="self" type="application/rss+xml"/><item><title>D3.js による SVG 描画の基本</title><link>https://maku.blog/p/v38nmhw/</link><pubDate>Tue, 08 Aug 2023 00:00:00 +0000</pubDate><guid>https://maku.blog/p/v38nmhw/</guid><description>D3.js は、クライアントサイド JavaScript で SVG 描画を行うためのライブラリです。 素の JavaScript（バニラ JavaScript) だけでも svg 要素を動的に構築していくことはできますが、D3.js を使うことでよりシンプルな API を使って描画処理を記述することができます。 ここでは、D3.js で基礎的な SVG 描画を行う方法を紹介します。
矩形を 1 つ追加する D3.js で矩形を描画するには、d3.select() で svg 要素を選択し（D3 セレクションオブジェクトを取得）、そこに append() メソッドで rect 要素を追加します。 そして、メソッドチェーンさせる形で attr() を呼び出し、rect の属性（サイズや色）を設定していきます。
次の例では、svg 要素に緑色の矩形を 1 つ追加しています。 rect 要素の塗り潰し色は fill 属性で指定することに注意してください（CSS の "background" プロパティとは名前が異なります）。
図: 矩形の表示 &amp;lt;svg id=&amp;#34;svg-wp3vzdr&amp;#34; width=&amp;#34;200&amp;#34; height=&amp;#34;100&amp;#34;&amp;gt;&amp;lt;/svg&amp;gt; &amp;lt;script&amp;gt; d3.select(&amp;#34;#svg-wp3vzdr&amp;#34;) // svg 要素を選択 .append(&amp;#34;rect&amp;#34;) // svg 内に rect 要素を追加 .attr(&amp;#34;x&amp;#34;, 10) // rect 要素の属性値を設定 .attr(&amp;#34;y&amp;#34;, 10) .</description></item><item><title>SVG 画像をダークモードに対応させる</title><link>https://maku.blog/p/shr62rs/</link><pubDate>Wed, 01 Nov 2023 00:00:00 +0000</pubDate><guid>https://maku.blog/p/shr62rs/</guid><description>何をするか SVG 内に style 要素を埋め込んで、ブラウザのダークモードの設定 (ON/OFF) に連動して各描画要素の色を変更する方法を説明します。
DarkMode: ON OFF 図: ダークモードに対応した SVG 上記の SVG 要素では、ブラウザのダークモード設定に応じて、各描画要素の色 (fill) を切り替えるようにしています。 さらに、現在のダークモード設定を示す ON/OFF というテキストの表示・非表示も切り替えています。
（ちなみに、この Web サイト『まくろぐ』全体は、ダークモード設定によって配色が変わるようにはなってません）
CSS のメディアクエリでダークモード用スタイルを定義する CSS のメディアクエリ (@media) を使うと、ブラウザのダークモード設定に応じたスタイル定義を行うことができます。
CSS のメディアクエリの使い方 /* ここに共通のスタイル定義 */ @media(prefers-color-scheme: light) { /* ここにライトモード時のスタイル定義 */ } @media(prefers-color-scheme: dark) { /* ここにダークモード時のスタイル定義 */ } SVG には style 要素を埋め込むことができるので、そこでメディアクエリを使えば、ダークモード設定に連動する SVG を作成することができます。
SVG に style 設定を埋め込む例 &amp;lt;svg width=&amp;#34;100&amp;#34; viewBox=&amp;#34;0 0 40 30&amp;#34;&amp;gt; &amp;lt;circle cx=&amp;#34;20&amp;#34; cy=&amp;#34;15&amp;#34; r=&amp;#34;10&amp;#34; fill=&amp;#34;blue&amp;#34; /&amp;gt; &amp;lt;style&amp;gt; @media(prefers-color-scheme: dark) { /* ブラウザのダークモードが ON のときは赤色にする */ circle { fill: red; } } &amp;lt;/style&amp;gt; &amp;lt;/svg&amp;gt; ダークモードに対応した SVG 要素の例 最初に表示した SVG は、次のようなコードで構成されています。 svg 要素内に、メディアクエリを含んだ style 要素が埋め込まれているところがポイントです。</description></item><item><title>SVG の defs 要素で図形を定義して use で使い回す</title><link>https://maku.blog/p/wkrp4mf/</link><pubDate>Sun, 15 Oct 2023 00:00:00 +0000</pubDate><guid>https://maku.blog/p/wkrp4mf/</guid><description>defs と use の基本 SVG の defs 要素内で定義した描画要素（rect や path、g など）は、use 要素を使って繰り返し参照することができます。 defs 以下に定義した図形は、use 要素で参照するまで描画されません。
次の例では、defs 要素内に path 要素を 1 つ定義し、それを 5 つの use 要素から参照しています。
図: defs と use による図形の使い回し &amp;lt;svg style=&amp;#34;width: 300px;&amp;#34; viewBox=&amp;#34;0 0 200 60&amp;#34;&amp;gt; &amp;lt;defs&amp;gt; &amp;lt;path id=&amp;#34;tri&amp;#34; d=&amp;#34;M0,-10 L9,5 -9,5 Z&amp;#34; fill=&amp;#34;magenta&amp;#34; /&amp;gt; &amp;lt;/defs&amp;gt; &amp;lt;use href=&amp;#34;#tri&amp;#34; transform=&amp;#34;translate(20 30)&amp;#34; /&amp;gt; &amp;lt;use href=&amp;#34;#tri&amp;#34; transform=&amp;#34;translate(50 30)&amp;#34; /&amp;gt; &amp;lt;use href=&amp;#34;#tri&amp;#34; transform=&amp;#34;translate(85 30) scale(1.5)&amp;#34; /&amp;gt; &amp;lt;use href=&amp;#34;#tri&amp;#34; transform=&amp;#34;translate(129 30) scale(2)&amp;#34; /&amp;gt; &amp;lt;use href=&amp;#34;#tri&amp;#34; transform=&amp;#34;translate(170 30) rotate(90) scale(2)&amp;#34; /&amp;gt; &amp;lt;/svg&amp;gt; use 要素には transform 属性を指定できるので、上記のように、表示位置 (translate) や拡大率 (scale)、回転角度 (rotate) などの指定が可能です。</description></item><item><title>SVG の path 要素による円弧の描画例（A コマンド）</title><link>https://maku.blog/p/rpp2z3w/</link><pubDate>Wed, 11 Oct 2023 00:00:00 +0000</pubDate><guid>https://maku.blog/p/rpp2z3w/</guid><description>A コマンドのパラメーター SVG の path 要素の d 属性に A/a コマンドを指定すると、様々な形状の円弧（楕円の一部）を描画することができます（参考: path 要素のチートシート）。 パラメーターが多くて分かりにくいのでまとめておきます。
図: path 要素による円弧の描画
具体例 &amp;lt;svg width=&amp;#34;200&amp;#34; viewBox=&amp;#34;-20 -65 140 85&amp;#34;&amp;gt; &amp;lt;path d=&amp;#34;M0,0 A50 50 0 0 1 100 0&amp;#34; stroke=&amp;#34;black&amp;#34; fill=&amp;#34;none&amp;#34; /&amp;gt; &amp;lt;/svg&amp;gt; A/a コマンドは、円弧の始点として「現在の座標」を使うので、通常は上記のように、先行する M コマンドなどで始点座標を移動しておきします。 円弧の線だけを表示するには、stroke に線の色を指定し、fill に none（塗りつぶしなし）を指定しておく必要があります。
A コマンドには次の 7 つの数値パラメーターを指定します。 a コマンドの場合は、最後の終点座標 (x, y) の指定が、相対位置 (dx, dy) の指定に変わります。
A コマンドのパラメーター &amp;lt;rx&amp;gt; &amp;lt;ry&amp;gt; &amp;lt;x-axis-rotation&amp;gt; &amp;lt;large-arc-flag&amp;gt; &amp;lt;sweep-flag&amp;gt; &amp;lt;x&amp;gt; &amp;lt;y&amp;gt; パラメーター 説明 rx 円弧の X 軸半径 ry 円弧の Y 軸半径 x-axis-rotation X 軸からの傾き (radian) large-arch-flag 1: 大きな弧の部分を描画0: 小さな弧の部分を描画 sweep-flag 1: 時計回り (clockwise) になる弧の部分を描画0: 反時計回り (counterclockwise) になる弧の部分を描画 x (dx) 円弧の終点 X 座標（A コマンドなら絶対座標、a コマンドなら相対座標） y (dy) 円弧の終点 Y 座標（A コマンドなら絶対座標、a コマンドなら相対座標） 下記のギャラリーを見ると、具体的な指定方法を理解できると思います。</description></item><item><title>SVG 要素の上に別の HTML 要素を重ねて表示する</title><link>https://maku.blog/p/fmxdrcp/</link><pubDate>Wed, 04 Oct 2023 00:00:00 +0000</pubDate><guid>https://maku.blog/p/fmxdrcp/</guid><description>多数のデータを svg 要素を使用してプロットする場合、ブラウザの画面全体に svg 要素を広げて表示したいケースがあります。 このような場合、別の HTML 要素（ページタイトルや操作パネルなど）は、svg 要素の上に重ねて表示する必要があります。 ここでは、その方法として、svg 要素を背景として表示する方法と、他の要素を相対的に配置する方法の 2 つを紹介します。
svg 要素を背景として表示する方法 (position: fixed) デモ1（別ページで開く） この例では、svg 要素を position: fixed スタイルを用いて、画面全体に固定表示しています。 通常、position: fixed スタイルは、ウェブサイトのヘッダーを画面上部に固定する用途などで使用されますが、これを svg 要素に適用することで、背景画像のような効果を得ることができます。 svg 以外の要素は、まるで svg 要素が存在しないかのようにレイアウトされます。 position: fixed スタイルが適用された svg 要素は、デフォルトでは他の要素よりも前面に表示されてしまうため、これを背面に配置するために z-index: -1 を指定しています。
HTML &amp;lt;svg&amp;gt; &amp;lt;circle cx=&amp;#34;40&amp;#34; cy=&amp;#34;40&amp;#34; r=&amp;#34;25&amp;#34; fill=&amp;#34;royalblue&amp;#34; /&amp;gt; &amp;lt;circle cx=&amp;#34;100&amp;#34; cy=&amp;#34;40&amp;#34; r=&amp;#34;25&amp;#34; fill=&amp;#34;indigo&amp;#34; /&amp;gt; &amp;lt;circle cx=&amp;#34;160&amp;#34; cy=&amp;#34;40&amp;#34; r=&amp;#34;25&amp;#34; fill=&amp;#34;darkslateblue&amp;#34; /&amp;gt; &amp;lt;circle cx=&amp;#34;220&amp;#34; cy=&amp;#34;40&amp;#34; r=&amp;#34;25&amp;#34; fill=&amp;#34;darkmagenta&amp;#34; /&amp;gt; &amp;lt;/svg&amp;gt; &amp;lt;p&amp;gt; この p 要素の後ろに、svg 要素がページ全体に表示されています。 &amp;lt;/p&amp;gt; CSS * { margin: 0; box-sizing: border-box; } svg { position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: midnightblue; z-index: -1; /* 他の要素より奥に表示 */ } ☝️ マウスイベントを透過させる svg 要素の上に重なった p 要素上でのマウスイベントを svg 要素に伝播するには、p 要素に pointer-events: none を指定します。</description></item><item><title>SVG の marker 要素で矢印（マーカー）を描画する</title><link>https://maku.blog/p/hoiytvm/</link><pubDate>Mon, 25 Sep 2023 00:00:00 +0000</pubDate><guid>https://maku.blog/p/hoiytvm/</guid><description>SVG の marker 要素を使うと、line 要素などの線の先端に表示するマーカー形状を定義することができます。 多くの場合、矢印を表す三角形を使いますが、丸や四角など、任意の形状のマーカーを定義できます。
marker による矢印描画の基本 実装例 次の例では、line 要素の先端に marker で定義した三角形を割り当てています。 マーカー形状を分かりやすくするために、半透明の赤色で表示しています（通常は line の色と合わせます）。
図: marker 要素による矢印の描画 svg のコード &amp;lt;svg width=&amp;#34;480&amp;#34; height=&amp;#34;140&amp;#34; viewBox=&amp;#34;0 0 240 70&amp;#34; xmlns=&amp;#34;http://www.w3.org/2000/svg&amp;#34; style=&amp;#34;border: thin solid gray&amp;#34;&amp;gt; &amp;lt;!-- marker で矢印の形を定義する --&amp;gt; &amp;lt;defs&amp;gt; &amp;lt;marker id=&amp;#34;arrow&amp;#34; viewBox=&amp;#34;0 0 10 10&amp;#34; refX=&amp;#34;5&amp;#34; refY=&amp;#34;5&amp;#34; markerWidth=&amp;#34;16&amp;#34; markerHeight=&amp;#34;16&amp;#34; orient=&amp;#34;auto-start-reverse&amp;#34;&amp;gt; &amp;lt;path d=&amp;#34;M0,0 L10,5 L0,10 Z&amp;#34; fill=&amp;#34;red&amp;#34; opacity=&amp;#34;0.5&amp;#34; /&amp;gt; &amp;lt;/marker&amp;gt; &amp;lt;/defs&amp;gt; &amp;lt;!-- marker を割り当てる --&amp;gt; &amp;lt;line x1=&amp;#34;20&amp;#34; y1=&amp;#34;20&amp;#34; x2=&amp;#34;100&amp;#34; y2=&amp;#34;20&amp;#34; stroke=&amp;#34;green&amp;#34; stroke-width=&amp;#34;1&amp;#34; marker-end=&amp;#34;url(#arrow)&amp;#34; /&amp;gt; &amp;lt;line x1=&amp;#34;80&amp;#34; y1=&amp;#34;50&amp;#34; x2=&amp;#34;160&amp;#34; y2=&amp;#34;20&amp;#34; stroke=&amp;#34;red&amp;#34; stroke-width=&amp;#34;1&amp;#34; marker-start=&amp;#34;url(#arrow)&amp;#34; marker-end=&amp;#34;url(#arrow)&amp;#34; /&amp;gt; &amp;lt;line x1=&amp;#34;140&amp;#34; y1=&amp;#34;50&amp;#34; x2=&amp;#34;220&amp;#34; y2=&amp;#34;50&amp;#34; stroke=&amp;#34;blue&amp;#34; stroke-width=&amp;#34;1&amp;#34; marker-start=&amp;#34;url(#arrow)&amp;#34; /&amp;gt; &amp;lt;/svg&amp;gt; 解説 marker で矢印の形を定義する &amp;lt;defs&amp;gt; &amp;lt;marker id=&amp;#34;arrow&amp;#34; viewBox=&amp;#34;0 0 10 10&amp;#34; refX=&amp;#34;5&amp;#34; refY=&amp;#34;5&amp;#34; markerWidth=&amp;#34;16&amp;#34; markerHeight=&amp;#34;16&amp;#34; orient=&amp;#34;auto-start-reverse&amp;#34;&amp;gt; &amp;lt;path d=&amp;#34;M0,0 L10,5 L0,10 Z&amp;#34; fill=&amp;#34;red&amp;#34; opacity=&amp;#34;0.</description></item><item><title>SVG の path 要素によるベジェ曲線の描画例（C/S/Q/T コマンド）</title><link>https://maku.blog/p/ka6xumg/</link><pubDate>Sat, 23 Sep 2023 00:00:00 +0000</pubDate><guid>https://maku.blog/p/ka6xumg/</guid><description>svg の path 要素を使用すると、直線と曲線を組み合わせて多様な図形を描画できます。 図形の形状は、path 要素の d 属性に一連のコマンドを指定することで定義されます（参考: path 要素のチートシート）。
しかし、ベジェ曲線の制御点をどのように指定すれば、どのような曲線が描かれるのかが直感的に理解しにくいことがあります。 ここではさまざまな曲線の描画例を紹介します。
C / S コマンドによる 3 次ベジェ曲線 C コマンド は、2 つの制御点と終点を指定することで、始点（現在座標）と終点を曲線で繋ぎます。 path の d 属性の内容は、M始点 C制御点1 制御点2 終点 のような形で指定することになります。
(0, 0) (5, 70) (95, 70) (100, 0) 始点 制御点1 制御点2 終点 &amp;lt;path d="M0,0 C5,70 95,70 100,0" stroke="black" stroke-width="2" fill="none" /> (0, 50) (50, 150) (50, -50) (100, 50) 始点 制御点1 制御点2 終点 &amp;lt;path d="M0,50 C50,150 50,-50 100,50" stroke="black" stroke-width="2" fill="</description></item><item><title>SVG の viewBox の使い方とレスポンシブ対応</title><link>https://maku.blog/p/563uibg/</link><pubDate>Fri, 22 Sep 2023 00:00:00 +0000</pubDate><guid>https://maku.blog/p/563uibg/</guid><description>svg 要素の viewBox 属性について svg 要素内の各描画要素に設定する座標値のデフォルト単位はピクセル (px) ですが、上位の svg 要素に viewBox 属性が設定されている場合は、その論理的な座標系（ユーザー座標系）の座標値を指定することになります。 例えば、次のように viewBox を設定すると、画面上での svg 要素の表示サイズは 800px x 600px となりますが、svg 要素内に配置する各描画要素 (rect など）は、40x30 という仮想的なサイズの中で座標指定することになります。
viewBox の指定 &amp;lt;svg width=&amp;#34;800&amp;#34; height=&amp;#34;600&amp;#34; viewBox=&amp;#34;0 0 40 30&amp;#34;&amp;gt; viewBox 属性を指定してある場合は、width 属性と height 属性の一方を省略して記述できるようになります。 その場合は、viewBox のアスペクト比を考慮した width あるいは height が自動的に設定されます。 よって、上記の svg タグは次のように省略して記述することが可能です。
height の省略 &amp;lt;svg width=&amp;#34;800&amp;#34; viewBox=&amp;#34;0 0 40 30&amp;#34;&amp;gt; 下記の例では 1 つの rect 要素を配置していますが、これは svg 要素の左上 4 分の 1 を占める矩形を描画します。
&amp;lt;svg width=&amp;#34;200&amp;#34; viewBox=&amp;#34;0 0 40 20&amp;#34;&amp;gt; &amp;lt;rect x=&amp;#34;0&amp;#34; y=&amp;#34;0&amp;#34; width=&amp;#34;20&amp;#34; height=&amp;#34;10&amp;#34; fill=&amp;#34;steelblue&amp;#34; /&amp;gt; &amp;lt;/svg&amp;gt; 表示例 svg 要素のレスポンシブ対応 svg 要素も img 要素と同様に、CSS で max-width: 100%; と指定しておけば、横幅が足りなくなった場合に縮小して表示することができます。</description></item><item><title>SVG の g 要素の使い方</title><link>https://maku.blog/p/rx9hdei/</link><pubDate>Thu, 21 Sep 2023 00:00:00 +0000</pubDate><guid>https://maku.blog/p/rx9hdei/</guid><description>SVG の g 要素は、子要素をグループ化して操作を行うための要素です。 ここでは、g 要素をどのような用途で利用できるのかをまとめておきます。
子要素に共通のスタイル（色、太さなど）をセットする &amp;lt;svg width=&amp;#34;195&amp;#34; height=&amp;#34;60&amp;#34; style=&amp;#34;border: solid 1px gray;&amp;#34;&amp;gt; &amp;lt;g fill=&amp;#34;#cef&amp;#34; stroke=&amp;#34;blue&amp;#34; stroke-width=&amp;#34;1.5&amp;#34;&amp;gt; &amp;lt;rect x=&amp;#34;15&amp;#34; y=&amp;#34;15&amp;#34; width=&amp;#34;30&amp;#34; height=&amp;#34;30&amp;#34; /&amp;gt; &amp;lt;circle cx=&amp;#34;75&amp;#34; cy=&amp;#34;30&amp;#34; r=&amp;#34;15&amp;#34; /&amp;gt; &amp;lt;/g&amp;gt; &amp;lt;g fill=&amp;#34;#ffc&amp;#34; stroke=&amp;#34;darkorange&amp;#34; stroke-width=&amp;#34;1.5&amp;#34;&amp;gt; &amp;lt;rect x=&amp;#34;105&amp;#34; y=&amp;#34;15&amp;#34; width=&amp;#34;30&amp;#34; height=&amp;#34;30&amp;#34; /&amp;gt; &amp;lt;circle cx=&amp;#34;165&amp;#34; cy=&amp;#34;30&amp;#34; r=&amp;#34;15&amp;#34; /&amp;gt; &amp;lt;/g&amp;gt; &amp;lt;/svg&amp;gt; この例では、2 つの g 要素の下に、rect と circle を 1 つずつ配置しています。 それらの塗りつぶし色 (fill) や枠線の色 (stroke) は、親の g 要素にセットしたものが使用されます。
多数の描画要素に同じスタイルを割り当てたいときは、g 要素でまとめてスタイル設定すると効率がよいです。
子要素の座標をまとめて移動する (transform) Hello! &amp;lt;svg width=&amp;#34;180&amp;#34; height=&amp;#34;60&amp;#34; style=&amp;#34;border: thin solid gray;&amp;#34;&amp;gt; &amp;lt;g transform=&amp;#34;translate(50 30)&amp;#34;&amp;gt; &amp;lt;circle cx=&amp;#34;0&amp;#34; cy=&amp;#34;0&amp;#34; r=&amp;#34;10&amp;#34; fill=&amp;#34;red&amp;#34; /&amp;gt; &amp;lt;text x=&amp;#34;15&amp;#34; y=&amp;#34;2&amp;#34; dominant-baseline=&amp;#34;middle&amp;#34; font-size=&amp;#34;20&amp;#34; font-weight=&amp;#34;800&amp;#34; fill=&amp;#34;blue&amp;#34;&amp;gt; Hello!</description></item><item><title>SVG チートシート</title><link>https://maku.blog/p/kq6gwfn/</link><pubDate>Sat, 09 Sep 2023 00:00:00 +0000</pubDate><guid>https://maku.blog/p/kq6gwfn/</guid><description>svg 要素内に配置できる描画要素のまとめです。 座標値のデフォルトの単位はピクセル (px) ですが、svg 要素に viewBox が設定されている場合は viewBox 内の座標系で座標値を指定します。
text 要素（テキスト） text 要素の例 &amp;lt;text x=&amp;#34;20&amp;#34; y=&amp;#34;55&amp;#34; font-size=&amp;#34;20&amp;#34; fill=&amp;#34;red&amp;#34;&amp;gt; 表示するテキスト &amp;lt;/text&amp;gt; 表示するテキスト 属性 説明 設定例 x テキストアンカーポイントの X 座標 100, 50% y テキストアンカーポイントの Y 座標 100, 50% text-anchor 水平方向のアンカーポイント * start &amp;hellip; テキスト先頭（ltr 言語なら左端）
* middle &amp;hellip; 中央* end &amp;hellip; テキスト末尾（ltr 言語なら右端） dominant-baseline 垂直方向のベースライン * auto &amp;hellip; 通常は下端* middle &amp;hellip; 中央* hanging &amp;hellip; 通常は上端 font-size フォントサイズ 30 font-weight 文字の太さ 600 fill テキスト内部の色 red, rgb(255, 0, 0),rgba(255, 0, 0, 0.</description></item></channel></rss>