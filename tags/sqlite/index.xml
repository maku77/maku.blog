<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>SQLite on まくろぐ</title><link>https://maku.blog/tags/sqlite/</link><description>Recent content in SQLite on まくろぐ</description><generator>Hugo</generator><language>ja-jp</language><lastBuildDate>Sun, 01 Aug 2010 00:00:00 +0900</lastBuildDate><atom:link href="https://maku.blog/tags/sqlite/index.xml" rel="self" type="application/rss+xml"/><item><title>SQLite のテーブル作成に関するメモ</title><link>https://maku.blog/p/2iccv8a/</link><pubDate>Sun, 01 Aug 2010 00:00:00 +0900</pubDate><guid>https://maku.blog/p/2iccv8a/</guid><description>&lt;h2 id="sqlite-3-のフィールド型">SQLite 3 のフィールド型&lt;/h2>
&lt;p>テーブル作成時 (&lt;code>CREATE TABLE&lt;/code>) に指定したフィールド定義に含まれているテキストにより、以下のようにフィールド型が決定されます。&lt;/p>
&lt;ul>
&lt;li>&lt;b>INTEGER 型&lt;/b>: &lt;code>INT&lt;/code> という文字列を含む場合。&lt;/li>
&lt;li>&lt;b>TEXT 型&lt;/b>: &lt;code>CHAR&lt;/code>、&lt;code>CLOB&lt;/code>、&lt;code>TEXT&lt;/code> を含む場合。&lt;/li>
&lt;li>&lt;b>NONE 型&lt;/b>: &lt;code>BLOB&lt;/code> を含む型、あるいはデータ型が特定されない場合。&lt;/li>
&lt;li>&lt;b>NUMERIC 型&lt;/b>: それ以外の場合。&lt;/li>
&lt;/ul>
&lt;h2 id="テーブルが存在しない場合だけテーブルを作成する-if-not-exists">テーブルが存在しない場合だけテーブルを作成する (IF NOT EXISTS)&lt;/h2>

&lt;figure class="xCodeBlock">

&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="k">CREATE&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">TABLE&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">IF&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">NOT&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">EXISTS&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">tbl&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">id&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">INTEGER&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">PRIMARY&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">KEY&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">name&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">TEXT&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">bin&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">BLOB&lt;/span>&lt;span class="p">);&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>逆に、テーブルが存在する場合だけテーブルを削除するということもできます。
この場合は、&lt;code>IF NOT EXISTS&lt;/code> の代わりに、&lt;strong>&lt;code>IF EXISTS&lt;/code>&lt;/strong> を使用します。&lt;/p>

&lt;figure class="xCodeBlock">

&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="k">DROP&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">TABLE&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">IF&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">EXISTS&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">tbl&lt;/span>&lt;span class="p">;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;h2 id="null-の追加を禁止する-not-null">NULL の追加を禁止する (NOT NULL)&lt;/h2>
&lt;p>フィールドの定義時に、&lt;strong>&lt;code>NOT NULL&lt;/code>&lt;/strong> というフィールド制約を加えておくと、データ追加時にそのフィールドの値を省略できないようになります。&lt;/p>

&lt;figure class="xCodeBlock">

&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="k">CREATE&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">TABLE&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">tbl&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">f1&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">NOT&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">NULL&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">f2&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">f3&lt;/span>&lt;span class="p">);&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>


&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">動作確認&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">sqlite&amp;gt; INSERT INTO tbl(f1, f2) VALUES(100, 200);
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sqlite&amp;gt; INSERT INTO tbl(f2, f3) VALUES(200, 300);
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">SQL error: tbl.f1 may not be NULL&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;h2 id="同じ値の入力を禁止する-unique">同じ値の入力を禁止する (UNIQUE)&lt;/h2>
&lt;p>フィールドの定義時に、&lt;code>UNIQUE&lt;/code> というフィールド制約を加えることで、別のレコードに入っている値と同じ値を追加できないようになります。&lt;/p></description></item><item><title>SQLite 雑多メモ</title><link>https://maku.blog/p/w5x4797/</link><pubDate>Sun, 16 Nov 2008 00:00:00 +0900</pubDate><guid>https://maku.blog/p/w5x4797/</guid><description>&lt;h2 id="sqlite-にできないこと">SQLite にできないこと&lt;/h2>
&lt;p>&lt;a href="http://www.sqlite.org/omitted.html">SQL Features That SQLite Does Not Implement&lt;/a> より。&lt;/p>
&lt;ul>
&lt;li>ユーザごとにアクセス制限ができない。
&lt;ul>
&lt;li>&lt;code>GRANT&lt;/code> によるアクセス権限の制御はできない。&lt;/li>
&lt;li>SQLite にはデータベースサーバが存在せず、クライアントが直接 DB ファイルにアクセスする形式のため、サーバでの &lt;code>GRANT&lt;/code> によるアクセス権限の制御ができない。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>そのユーザーがファイルにアクセスできるということは、そのデータベースに対して何でもできるということを示す。
&lt;ul>
&lt;li>&lt;code>VIEW&lt;/code> は使えるがリードオンリーである。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="sqlite-2-と-sqlite-3-の違い">SQLite 2 と SQLite 3 の違い&lt;/h2>
&lt;ul>
&lt;li>バージョン 3 では BLOB (Binary Large OBject) がサポートされた。&lt;/li>
&lt;li>バージョン 3 のほうがデータベースファイルのサイズがコンパクトになる。&lt;/li>
&lt;li>整数の連番を生成する ROWID がバージョン 2 では 32bit、バージョン 3 では 64bit。&lt;/li>
&lt;/ul>
&lt;h2 id="sqlite-2-のデータベースファイルを-sqlite-3-のデーターベース形式に変換する">SQLite 2 のデータベースファイルを SQLite 3 のデーターベース形式に変換する&lt;/h2>
&lt;pre tabindex="0">&lt;code>$ sqlite db2 .dump | sqlite3 db3
&lt;/code>&lt;/pre>&lt;h2 id="各言語用の-sqlite-ライブラリ">各言語用の SQLite ライブラリ&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="http://www.sqlite.org/cvstrac/wiki?p=SqliteWrappers.">SQLite Wrappers&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="python-で-sqlite-を操作する">Python で SQLite を操作する&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://www.python.org/dev/peps/pep-0249/">PEP 249 -- Python Database API Specification v2.0&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>SQLite の日時関連の処理</title><link>https://maku.blog/p/qwtoj94/</link><pubDate>Sat, 17 Feb 2007 00:00:00 +0900</pubDate><guid>https://maku.blog/p/qwtoj94/</guid><description>&lt;h2 id="現在の日時を取得するテキスト形式">現在の日時を取得する（テキスト形式）&lt;/h2>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">日付＋時刻&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">sqlite&amp;gt; select datetime(&amp;#39;now&amp;#39;)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2007-02-17 07:53:30&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>


&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">日付のみ&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">sqlite&amp;gt; select date(&amp;#39;now&amp;#39;)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2007-02-17&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>


&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">時刻のみ&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">sqlite&amp;gt; select time(&amp;#39;now&amp;#39;)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">07:53:30&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>これらのデータ型は TEXT 型です。&lt;/p>

&lt;figure class="xCodeBlock">

&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">sqlite&amp;gt; select typeof(datetime(&amp;#39;now&amp;#39;));
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">text&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;h2 id="現在の日時を現地時間で取得するテキスト形式">現在の日時を現地時間で取得する（テキスト形式）&lt;/h2>

&lt;figure class="xCodeBlock">

&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">sqlite&amp;gt; select datetime(&amp;#39;now&amp;#39;, &amp;#39;localtime&amp;#39;)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2007-02-17 16:53:30
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sqlite&amp;gt; select date(&amp;#39;now&amp;#39;, &amp;#39;localtime&amp;#39;)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2007-02-17
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sqlite&amp;gt; select time(&amp;#39;now&amp;#39;, &amp;#39;localtime&amp;#39;)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">16:53:30&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;h2 id="ある標準時を現地時刻へ変換する">ある標準時を現地時刻へ変換する&lt;/h2>

&lt;figure class="xCodeBlock">

&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">sqlite&amp;gt; select datetime(&amp;#39;2007-02-17 21:30:00&amp;#39;, &amp;#39;localtime&amp;#39;);
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2007-02-18 06:30:00
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sqlite&amp;gt; select time(&amp;#39;21:30:00&amp;#39;, &amp;#39;localtime&amp;#39;);
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">06:30:00&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure></description></item></channel></rss>