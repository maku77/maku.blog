<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>AWS/S3 on まくろぐ</title><link>https://maku.blog/tags/aws/s3/</link><description>Recent content in AWS/S3 on まくろぐ</description><generator>Hugo</generator><language>ja-jp</language><lastBuildDate>Fri, 09 Apr 2021 00:00:00 +0900</lastBuildDate><atom:link href="https://maku.blog/tags/aws/s3/index.xml" rel="self" type="application/rss+xml"/><item><title>AWS CloudFormation で S3 バケットのリソースを作成する</title><link>https://maku.blog/p/ugt6gr4/</link><pubDate>Fri, 09 Apr 2021 00:00:00 +0900</pubDate><guid>https://maku.blog/p/ugt6gr4/</guid><description>&lt;h2 id="s3-バケット定義の基本">S3 バケット定義の基本&lt;/h2>
&lt;p>AWS CloudFormation で S3 バケットを作成・設定するには、次のようにテンプレートファイル内で &lt;strong>&lt;code>AWS::S3::Bucket&lt;/code>&lt;/strong> タイプのリソースを定義します。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">template.yml&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">AWSTemplateFormatVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;2010-09-09&amp;#39;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">Resources&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">MyBucket&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">Type&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">AWS::S3::Bucket&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>上記の例では、論理 ID (Logical ID) が &lt;code>MyBucket&lt;/code> の S3 バケットを定義しています。
論理 ID はこのテンプレートで生成するスタック内で一意の ID です。
実際に生成される S3 バケット名（物理 ID）は CloudFormation が自動で生成します（後述）。&lt;/p>
&lt;p>このテンプレートを使って、CloudFormation スタック（ここでは S3 バケットのみ含まれる）を生成するには、次のように &lt;strong>&lt;code>aws cloudformation deploy&lt;/code>&lt;/strong> コマンドを実行します。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">mystack スタックを生成&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">$ aws cloudformation deploy --template-file template.yml --stack-name mystack&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>スタック内に生成された AWS リソースの一覧は次のように確認できます。&lt;/p>

&lt;figure class="xCodeBlock">

&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">$ aws cloudformation describe-stack-resources --stack-name mystack
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">StackResources:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">- DriftInformation:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> StackResourceDriftStatus: NOT_CHECKED
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> LogicalResourceId: MyBucket
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> PhysicalResourceId: mystack-mybucket-bq8iux8uepew
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ResourceStatus: CREATE_COMPLETE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ResourceType: AWS::S3::Bucket
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> StackId: arn:aws:cloudformation:ap-northeast-1:123456789012:stack/mystack/c7e06a46-9902-11eb-9a29-8b1f770a16f7
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> StackName: mystack
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Timestamp: &amp;#39;2021-04-09T07:09:13.622000+00:00&amp;#39;&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>&lt;code>PhysicalResourceId&lt;/code> のところを見ると、実際に作成された S3 バケットの物理 ID (Physical ID) が分かります。&lt;/p></description></item></channel></rss>