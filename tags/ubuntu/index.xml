<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Ubuntu on まくろぐ</title><link>https://maku.blog/tags/ubuntu/</link><description>Recent content in Ubuntu on まくろぐ</description><generator>Hugo</generator><language>ja-jp</language><lastBuildDate>Thu, 20 Jan 2022 00:00:00 +0900</lastBuildDate><atom:link href="https://maku.blog/tags/ubuntu/index.xml" rel="self" type="application/rss+xml"/><item><title>Linuxメモ: Netplan で Ubuntu のネットワーク設定を行う</title><link>https://maku.blog/p/7q3dnx8/</link><pubDate>Thu, 20 Jan 2022 00:00:00 +0900</pubDate><guid>https://maku.blog/p/7q3dnx8/</guid><description>&lt;h2 id="netplan-とは">Netplan とは&lt;/h2>
&lt;p>&lt;a href="https://netplan.io">Netplan&lt;/a> は Linux のネットワーク設定を簡潔な YAML ファイルで行う仕組みで、Ubuntu 18.04 以降（正確には 17 以降）で採用されています。
昔の Ubuntu/Debian で使用されていた &lt;code>/etc/network/interfaces&lt;/code> という設定ファイルはもう使われていません。&lt;/p>
&lt;p>実際のネットワーク管理は、バックエンドで動作する NetworkManager や systemd-networkd といったネットワークデーモンが行うのですが、Netplan は YAML 設定ファイルの内容を適切な形に変換して、これらのネットワークデーモンに渡してくれます。
つまり、バックエンドでどのようなネットワークデーモンが動いているかを意識せずに、統一されたわかりやすい YAML ファイルでネットワーク設定を行うことができます。&lt;/p>
&lt;p>Netplan は次のように振る舞います。&lt;/p>
&lt;ol>
&lt;li>システム起動時に Netplan が設定ファイル (&lt;code>/etc/netplan/*.yaml&lt;/code>) を読み込んで、各ネットワークデーモン用の設定値を &lt;code>/run&lt;/code> 以下へ書き出す&lt;/li>
&lt;li>各ネットワークデーモンが渡された情報に基づいてネットワーク設定を行う&lt;/li>
&lt;/ol>


&lt;figure class="xImage">
 &lt;img style="" width="300" height="auto" src="../../p/7q3dnx8/img-001.svg" alt="/p/7q3dnx8/img-001.svg" />
 &lt;figcaption>図: netplan.io のサイトより&lt;/figcaption>
&lt;/figure>

&lt;p>バックエンドのネットワークデーモンとして何を使うかは、設定ファイルの &lt;code>renderer&lt;/code> 部分で指定できるようになっていますが、デフォルトでは次のように動作します。&lt;/p>
&lt;ul>
&lt;li>Wifi や 無線 WAN/LTE の設定 &amp;hellip; NetworkManager に渡される&lt;/li>
&lt;li>それ以外のネットワーク（有線LANなど）の設定 &amp;hellip; networkd に渡される&lt;/li>
&lt;/ul>
&lt;p>よって、通常はどのネットワークデーモンを使うかを明示する必要はありません。&lt;/p>
&lt;h2 id="設定ファイルの読み込まれる順序">設定ファイルの読み込まれる順序&lt;/h2>
&lt;p>Netplan はすべての &lt;strong>&lt;code>/etc/netplan/*.yaml&lt;/code>&lt;/strong> ファイルを読み込みます。
複数のファイルが存在する場合は、ファイル名のアルファベット順に読み込まれ、後に読み込まれたファイルの設定値が優先的に使用されます。
例えば、&lt;/p>
&lt;ul>
&lt;li>/etc/netplan/50-cloud-init.yaml&lt;/li>
&lt;li>/etc/netplan/99-custom.yaml&lt;/li>
&lt;/ul>
&lt;p>というファイルがある場合、&lt;code>50-cloud-init.yaml&lt;/code> で設定された値は &lt;code>99-custom.yaml&lt;/code> の設定値によって上書きされます。&lt;/p></description></item></channel></rss>