<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Parcel on まくろぐ</title><link>https://maku.blog/tags/parcel/</link><description>Recent content in Parcel on まくろぐ</description><generator>Hugo</generator><language>ja-jp</language><lastBuildDate>Tue, 01 Sep 2020 00:00:00 +0900</lastBuildDate><atom:link href="https://maku.blog/tags/parcel/index.xml" rel="self" type="application/rss+xml"/><item><title>Parcel でビルドした Web サイトが GitHub Pages で動作しないとき</title><link>https://maku.blog/p/m7jw8ju/</link><pubDate>Tue, 01 Sep 2020 00:00:00 +0900</pubDate><guid>https://maku.blog/p/m7jw8ju/</guid><description>&lt;p>React アプリを Parcel でビルドして GitHub Pages で公開しようとしたら、真っ白な画面になってしまったので対応方法のメモです。
原因は、トップページの &lt;code>index.html&lt;/code> から読み込んでいる JavaScript ファイルのパスが、&lt;code>/index.js&lt;/code> のように、ドメインルートからの相対パスになっていることでした。&lt;/p>
&lt;p>GitHub Pages で公開する Web サイトの URL が、&lt;/p>
&lt;ul>
&lt;li>&lt;code>https://yourname.github.io/&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>であれば問題ないのですが、&lt;/p>
&lt;ul>
&lt;li>&lt;code>https://yourname.github.io/project名/&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>になっている場合は、読み込むファイルは &lt;code>/project名/index.js&lt;/code> になっていないといけません。
これを解決するには、例えば、Parcel でビルドしているときは &lt;strong>&lt;code>--public-url&lt;/code>&lt;/strong> オプションを使って、次のように指定します。&lt;/p>

&lt;figure class="xCodeBlock">

&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">$ parcel build src/index.html -d build --public-url &amp;#34;/project名/&amp;#34;&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>こうすることで、トップページから &lt;code>/index.js&lt;/code> というパスで参照していたものが &lt;code>/project名/index.js&lt;/code> に変わってうまく動作するようになります。&lt;/p>
&lt;p>&lt;code>npm run build&lt;/code> で Web サイトのビルドを行っているのであれば、&lt;code>package.json&lt;/code> 内のスクリプト定義で次のように記述しておけばよいでしょう。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">package.json&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-js" data-lang="js">&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="s2">&amp;#34;scripts&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;start&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;parcel src/index.html --open&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;build&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;rm -rf build &amp;amp;&amp;amp; parcel build src/index.html -d build --public-url &amp;#39;/project名/&amp;#39;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;p>NPM スクリプト内に GitHub のプロジェクト名を含めるのが嫌なときは、CI/CD サーバー上のビルド設定でパラメータ指定するのがよいかもしれません。
例えば、GitHub Actions を使っている場合は、次のような感じで NPM スクリプトに追加パラメータを指定することができます。&lt;/p></description></item></channel></rss>