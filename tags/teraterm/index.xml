<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>TeraTerm on まくろぐ</title><link>https://maku.blog/tags/teraterm/</link><description>Recent content in TeraTerm on まくろぐ</description><generator>Hugo</generator><language>ja-jp</language><lastBuildDate>Tue, 19 Apr 2011 00:00:00 +0900</lastBuildDate><atom:link href="https://maku.blog/tags/teraterm/index.xml" rel="self" type="application/rss+xml"/><item><title>TeraTerm マクロのメモ</title><link>https://maku.blog/p/kx7myd9/</link><pubDate>Tue, 19 Apr 2011 00:00:00 +0900</pubDate><guid>https://maku.blog/p/kx7myd9/</guid><description>&lt;h2 id="マクロの起動の仕方">マクロの起動の仕方&lt;/h2>
&lt;h3 id="teraterm-が起動している場合">TeraTerm が起動している場合&lt;/h3>
&lt;ol>
&lt;li>メニューから &lt;strong>Control&lt;/strong> → &lt;strong>Macro&lt;/strong> でマクロファイル (.ttl) を選択&lt;/li>
&lt;/ol>
&lt;h3 id="teraterm-を起動してマクロを実行する場合">TeraTerm を起動してマクロを実行する場合&lt;/h3>
&lt;pre tabindex="0">&lt;code>C:\&amp;gt; ttermpro.exe /M=sample.ttl
&lt;/code>&lt;/pre>&lt;h3 id="teraterm-を起動せずにマクロを実行する場合">TeraTerm を起動せずにマクロを実行する場合&lt;/h3>
&lt;pre tabindex="0">&lt;code>C:\&amp;gt; ttpmacro.exe sample.ttl
&lt;/code>&lt;/pre>&lt;p>マクロの実行中止ダイアログを表示しないようにするには、&lt;code>/V&lt;/code> オプションをつけます。
ttpmacro.exe でマクロを実行した場合、マクロ中で &lt;code>connect&lt;/code> コマンドを実行したときに TeraTerm が表示されます。&lt;/p>

&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">例1: COM1 ポートでシリアル接続する場合&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">connect &amp;#39;/C=1&amp;#39;&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>


&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">例2: TCP/IP (Telnet) 接続する場合&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">connect &amp;#39;host.example.com&amp;#39;&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>


&lt;figure class="xCodeBlock">
&lt;figcaption class="xCodeBlock_title">例3: TCP/IP (any port) 接続する場合&lt;/figcaption>
&lt;div class="xCodeBlock_code">&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">connect &amp;#39;host.example.com:8080&amp;#39;&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>
&lt;/figure>

&lt;h2 id="文字列を表示する-dispstr">文字列を表示する (dispstr)&lt;/h2>
&lt;p>&lt;code>dispstr&lt;/code> を使えば、TeraTerm アプリケーションの機能として文字列を表示できます。
マクロの実行経過などを表示したい場合などは &lt;code>dispstr&lt;/code> を使うのがよいでしょう。&lt;/p>
&lt;pre tabindex="0">&lt;code>dispstr &amp;#39;Hello World&amp;#39;#$0A
&lt;/code>&lt;/pre>&lt;p>末尾の &lt;code>#$0A&lt;/code> は改行コード (LF) を表しています。&lt;/p>
&lt;p>間違えやすいものに &lt;code>sendln&lt;/code> がありますが、これは接続先の端末に対してコマンドを送るものです。
以下のように &lt;code>echo&lt;/code> コマンドを送信した場合は、リモートの端末上で &lt;code>echo&lt;/code> コマンドが実行されることになります。&lt;/p>
&lt;pre tabindex="0">&lt;code>sendln &amp;#39;echo Hello World&amp;#39;
&lt;/code>&lt;/pre>&lt;h2 id="メッセージボックスを表示する-messagebox">メッセージボックスを表示する (messagebox)&lt;/h2>
&lt;pre tabindex="0">&lt;code>messagebox &amp;#34;Hello TTL!&amp;#34; &amp;#34;It&amp;#39;s cool&amp;#34;
&lt;/code>&lt;/pre>&lt;h2 id="ビープ音を出す-beep">ビープ音を出す (beep)&lt;/h2>
&lt;p>ビープ音を出すコマンドの書式は以下の通りです。&lt;/p></description></item><item><title>TeraTerm でログを自動保存する</title><link>https://maku.blog/p/oi9yak2/</link><pubDate>Fri, 17 Jul 2009 00:00:00 +0900</pubDate><guid>https://maku.blog/p/oi9yak2/</guid><description>&lt;h2 id="teraterm-起動時にログを自動でファイルに保存するようにする">TeraTerm 起動時にログを自動でファイルに保存するようにする&lt;/h2>
&lt;p>（Version: TeraTerm 4.62 で確認）&lt;/p>
&lt;ol>
&lt;li>メニューから、&lt;kbd>&lt;samp>Setup&lt;/samp>&lt;/kbd> → &lt;kbd>&lt;samp>Additional settings&amp;hellip;&lt;/samp>&lt;/kbd>&lt;/li>
&lt;li>Log のタブを開き、例えば以下のように設定
&lt;ul>
&lt;li>Default Log File Name (strftime format): &lt;kbd>%Y%m%dT%H%M%S-log.txt&lt;/kbd>&lt;/li>
&lt;li>Default Log Save Folder: &lt;kbd>D:\y\log\teraterm&lt;/kbd>&lt;/li>
&lt;li>Auto start loggin: &lt;kbd>Check&lt;/kbd>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>最後に &lt;kbd>&lt;samp>Setup&lt;/samp>&lt;/kbd> → &lt;kbd>&lt;samp>Save setup&lt;/samp>&lt;/kbd> で設定を保存&lt;/li>
&lt;/ol>
&lt;p>これで、TeraTerm 起動時に自動で &lt;code>20090717T201506-log.txt&lt;/code> のような名前で、ログファイルを作成してくれるようになります。&lt;/p>
&lt;h2 id="ログファイルの各行に-windows-システム時刻を付加する">ログファイルの各行に Windows システム時刻を付加する&lt;/h2>
&lt;p>以下のように設定しておくと、&lt;/p>
&lt;ol>
&lt;li>メニューから &lt;kbd>&lt;samp>File&lt;/samp>&lt;/kbd> → &lt;kbd>&lt;samp>Log&amp;hellip;&lt;/samp>&lt;/kbd> （ログ取得中の場合はいったんログ取得を停止してから）&lt;/li>
&lt;li>Option から &lt;kbd>&lt;samp>Timestamp&lt;/samp>&lt;/kbd> にチェックを入れて &lt;kbd>&lt;samp>Save&lt;/samp>&lt;/kbd>&lt;/li>
&lt;li>最後に &lt;kbd>&lt;samp>Setup&lt;/samp>&lt;/kbd> → &lt;kbd>&lt;samp>Save setup&lt;/samp>&lt;/kbd> で設定を保存&lt;/li>
&lt;/ol>
&lt;p>ログファイルの各行に以下のような、時刻のプレフィックスが付くようになります。&lt;/p>
&lt;pre tabindex="0">&lt;code>[Tue Jun 28 13:37:27.890 2011] ...
[Tue Jun 28 13:37:30.590 2011] ...
[Tue Jun 28 13:37:30.590 2011] ...
&lt;/code>&lt;/pre>&lt;h2 id="ログ取得のダイアログを非表示する">ログ取得のダイアログを非表示する&lt;/h2>
&lt;p>ログ取得中のダイアログが邪魔な場合は、以下のように消すことができます。&lt;/p></description></item></channel></rss>