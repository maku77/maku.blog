<!doctype html><html lang=ja-jp>
<head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#">
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<title>まくろぐ</title>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-63069513-4"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','UA-63069513-4')</script><meta property="og:site_name" content="まくろぐ">
<meta property="og:title" content="まくろぐ">
<meta property="og:type" content="website">
<meta property="og:url" content="https://maku.blog/">
<meta property="og:locale" content="ja_JP"><meta property="og:image" content="https://maku.blog/img/site-logo.png">
<meta property="og:image:width" content="1436">
<meta property="og:image:height" content="746">
<meta property="og:description" content="まくの日記や雑多メモ。">
<meta property="fb:app_id" content="1572235596285254"><link rel=stylesheet href=./css/main.min.6b77bf17b61a7afcad6c078321c3b838d84d6fd87320e7556ec19bbd273c2794.css>
<link rel=icon sizes="16x16 32x32 48x48 64x64" href=./assets/favicon/favicon.ico>
<link rel=icon sizes=192x192 href=./assets/favicon/192x192.png>
<link rel=apple-touch-icon href=./assets/favicon/180x180.png>
<script src=https://code.jquery.com/jquery-3.5.1.slim.min.js integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" crossorigin=anonymous></script>
<style>.codoc-support{display:inline-block;margin:.5rem 0 0!important;padding:12px!important;width:210px!important;max-width:100%}.codoc-support .codoc-support-title{font-size:smaller!important;white-space:nowrap;margin-bottom:12px!important}.codoc-support .codoc-btn{width:180px!important}</style>
<script src=https://codoc.jp/js/cms.js data-css=black data-usercode=tp6ZPzTj3w defer></script>
</head>
<body>
<div id=xRoot>
<div id=xSiteHeader><a href=./>まくろぐ</a></div>
<div id=xContainer>
<nav id=xMenu aria-label=メニュー>
<div id=sidebar style=height:100%>
<div id=sidebar_notFixed>
<a href=./><img src=https://maku.blog/img/site-logo-sidebar.png></a>
<div class=xMenu_box data-sticky>
<form action=https://cse.google.com/cse target=_blank>
<div class=xSearchBox>
<input type=hidden name=cx value=partner-pub-6317852277883092:6890083468>
<input type=hidden name=ie value=UTF-8>
<input type=search name=q placeholder=サイト内検索 size=30 autocomplete=off>
<input type=submit value=検索></input>
</div>
</form>
<div class=xMenu_box_body>
</div>
</div>
<div class=xMenu_box data-sticky>
<h3 class=xMenu_box_title><a href=./latest/>新着</a></h3>
<div class=xMenu_box_body>
<div class=xBoxLink>
<a href=./p/euevcs8/>
Docker で Ansible の実行環境用のコンテナを作成する
<time>2022-07-02</time></a>
</div>
<div class=xBoxLink>
<a href=./p/n5emu3a/>
ConoHa VPS を借りて独自ドメインでアクセスできるようにする
<time>2022-06-27</time></a>
</div>
<div class=xBoxLink>
<a href=./p/oj9nzgt/>
Node.js で URL のパスを結合する (url-join)
<time>2022-06-22</time></a>
</div>
<div class=xBoxLink>
<a href=./p/9bku4cj/>
GitHub GraphQL API のクエリ例: ユーザー情報を取得する (viewer, user)
<time>2022-06-20</time></a>
</div>
<div class=xBoxLink>
<a href=./p/3o2doyb/>
GitHub GraphQL クエリ例: 組織の情報を取得する (organization)
<time>2022-06-20</time></a>
</div>
</div>
</div>
<div class=xMenu_box data-sticky>
<h3 class=xMenu_box_title><a href=./sitemap/>フォルダ</a></h3>
<div class=xMenu_box_body>
<div class=xNavTree>
<ul>
<li><a class=xNavTree-dir href=./p/3ftx6b2/>技術系</a>
<li><a class=xNavTree-dir href=./p/zb9ocav/>ツール</a>
<li><a class=xNavTree-dir href=./p/35odek9/>読書</a>
<li><a class=xNavTree-dir href=./p/ajj5753/>遊び</a>
<li><a class=xNavTree-dir href=./p/qb73pxx/>日記・コラム</a>
<li><a class=xNavTree-dir href=./p/syy4ryp/>設定</a>
<li><a class=xNavTree-dir href=./p/tsjyzrn/>雑多</a>
<li><a class=xNavTree-dir href=./p/hnoamfo/>管理人</a>
</ul>
</div>
</div>
</div>
<div class=xMenu_box data-sticky>
<h3 class=xMenu_box_title><a href=./tags/>タグ</a></h3>
<div class=xMenu_box_body><div class=xMenu_tag>
<a href=./tags/%E8%AA%AD%E6%9B%B8>読書 (79)</a>
</div><div class=xMenu_tag>
<a href=./tags/aws>aws (61)</a>
</div><div class=xMenu_tag>
<a href=./tags/azure>azure (58)</a>
</div><div class=xMenu_tag>
<a href=./tags/typescript>typescript (58)</a>
</div><div class=xMenu_tag>
<a href=./tags/%E6%97%A5%E8%A8%98>日記 (53)</a>
</div><div class=xMenu_tag>
<a href=./tags/next.js>next.js (37)</a>
</div><div class=xMenu_tag>
<a href=./tags/chatbot>chatbot (28)</a>
</div><div class=xMenu_tag>
<a href=./tags/react>react (28)</a>
</div><div class=xMenu_tag>
<a href=./tags/gnuplot>gnuplot (27)</a>
</div><div class=xMenu_tag>
<a href=./tags/aws/cdk>aws/cdk (26)</a>
</div><div class=xMenu_tag>
<a href=./tags/github>github (23)</a>
</div><div class=xMenu_tag>
<a href=./tags/bot-builder-sdk>bot-builder-sdk (21)</a>
</div><div class=xMenu_tag>
<a href=./tags/aws/dynamodb>aws/dynamodb (18)</a>
</div><div class=xMenu_tag>
<a href=./tags/graphql>graphql (18)</a>
</div><div class=xMenu_tag>
<a href=./tags/node.js>node.js (18)</a>
</div><div class=xMenu_tag>
<a href=./tags/aws/cloudformation>aws/cloudformation (16)</a>
</div><div class=xMenu_tag>
<a href=./tags/electron>electron (15)</a>
</div><div class=xMenu_tag>
<a href=./tags/linux>linux (15)</a>
</div><div class=xMenu_tag>
<a href=./tags/vs-code>vs-code (14)</a>
</div><div class=xMenu_tag>
<a href=./tags/javascript>javascript (13)</a>
</div><div class=xMenu_tag>
<a href=./tags/mongodb>mongodb (13)</a>
</div><div class=xMenu_tag>
<a href=./tags/aws/cognito>aws/cognito (12)</a>
</div><div class=xMenu_tag>
<a href=./tags/%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%A0>プログラム (11)</a>
</div><div class=xMenu_tag>
<a href=./tags/android>android (10)</a>
</div><div class=xMenu_tag>
<a href=./tags/aws/lambda>aws/lambda (10)</a>
</div><div class=xMenu_tag>
<a href=./tags/%E3%82%B2%E3%83%BC%E3%83%A0>ゲーム (10)</a>
</div><div class=xMenu_tag>
<a href=./tags/%E3%83%93%E3%83%AA%E3%83%A4%E3%83%BC%E3%83%89>ビリヤード (10)</a>
</div><div class=xMenu_tag>
<a href=./tags/java>java (9)</a>
</div><div class=xMenu_tag>
<a href=./tags/nginx>nginx (9)</a>
</div><div class=xMenu_tag>
<a href=./tags/python>python (9)</a>
</div><div class=xMenu_tag>
<a href=./tags/uml>uml (9)</a>
</div><div class=xMenu_tag>
<a href=./tags/%E3%82%BB%E3%83%9F%E3%83%8A%E3%83%BC%E8%AC%9B%E6%BC%94%E4%BC%9A>セミナー講演会 (9)</a>
</div><div class=xMenu_tag>
<a href=./tags/%E6%95%B0%E5%AD%A6>数学 (9)</a>
</div><div class=xMenu_tag>
<a href=./tags/3d>3d (8)</a>
</div><div class=xMenu_tag>
<a href=./tags/aws/sam>aws/sam (8)</a>
</div><div class=xMenu_tag>
<a href=./tags/firebase/firestore>firebase/firestore (8)</a>
</div><div class=xMenu_tag>
<a href=./tags/unity>unity (8)</a>
</div><div class=xMenu_tag>
<a href=./tags/webgl>webgl (8)</a>
</div><div class=xMenu_tag>
<a href=./tags/%E3%82%A2%E3%82%A4%E3%83%87%E3%82%A2>アイデア (8)</a>
</div><div class=xMenu_tag>
<a href=./tags/%E4%BB%95%E4%BA%8B>仕事 (8)</a>
</div><div class=xMenu_tag>
<a href=./tags/%E6%8A%80%E8%A1%93>技術 (8)</a>
</div><div class=xMenu_tag>
<a href=./tags/azure-cli>azure-cli (7)</a>
</div><div class=xMenu_tag>
<a href=./tags/azure-pipelines>azure-pipelines (7)</a>
</div><div class=xMenu_tag>
<a href=./tags/jade>jade (7)</a>
</div><div class=xMenu_tag>
<a href=./tags/%E3%83%87%E3%82%B6%E3%82%A4%E3%83%B3%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3>デザインパターン (7)</a>
</div><div class=xMenu_tag>
<a href=./tags/%E3%83%A9%E3%82%A4%E3%83%95%E3%83%8F%E3%83%83%E3%82%AF>ライフハック (7)</a>
</div><div class=xMenu_tag>
<a href=./tags/apollo>apollo (6)</a>
</div><div class=xMenu_tag>
<a href=./tags/aws/api-gateway>aws/api-gateway (6)</a>
</div><div class=xMenu_tag>
<a href=./tags/aws/cli>aws/cli (6)</a>
</div><div class=xMenu_tag>
<a href=./tags/azure-storage>azure-storage (6)</a>
</div><div class=xMenu_tag>
<a href=./tags/doxygen>doxygen (6)</a>
</div><div class=xMenu_tag>
<a href=./tags/firebase/cloudfunctions>firebase/cloudfunctions (6)</a>
</div><div class=xMenu_tag>
<a href=./tags/%E3%83%84%E3%83%BC%E3%83%AB>ツール (6)</a>
</div><div class=xMenu_tag>
<a href=./tags/ansible>ansible (5)</a>
</div><div class=xMenu_tag>
<a href=./tags/azure-table-storage>azure-table-storage (5)</a>
</div><div class=xMenu_tag>
<a href=./tags/luis>luis (5)</a>
</div><div class=xMenu_tag>
<a href=./tags/material-ui>material-ui (5)</a>
</div><div class=xMenu_tag>
<a href=./tags/qna-maker>qna-maker (5)</a>
</div><div class=xMenu_tag>
<a href=./tags/%E3%81%8A%E7%B5%B5%E3%81%8B%E3%81%8D>お絵かき (5)</a>
</div><div class=xMenu_tag>
<a href=./tags/%E6%8A%95%E8%B3%87>投資 (5)</a>
</div><div class=xMenu_tag>
<a href=./tags/%E7%94%9F%E3%81%8D%E6%96%B9>生き方 (5)</a>
</div><div class=xMenu_tag>
<a href=./tags/aws/ssm>aws/ssm (4)</a>
</div><div class=xMenu_tag>
<a href=./tags/c/c++>c/c++ (4)</a>
</div><div class=xMenu_tag>
<a href=./tags/eslint>eslint (4)</a>
</div><div class=xMenu_tag>
<a href=./tags/firebase>firebase (4)</a>
</div><div class=xMenu_tag>
<a href=./tags/html/css>html/css (4)</a>
</div><div class=xMenu_tag>
<a href=./tags/sql>sql (4)</a>
</div><div class=xMenu_tag>
<a href=./tags/windows>windows (4)</a>
</div><div class=xMenu_tag>
<a href=./tags/%E3%82%A8%E3%83%87%E3%82%A3%E3%82%BF>エディタ (4)</a>
</div><div class=xMenu_tag>
<a href=./tags/%E3%83%A6%E3%83%8B%E3%83%83%E3%83%88%E3%83%86%E3%82%B9%E3%83%88>ユニットテスト (4)</a>
</div><div class=xMenu_tag>
<a href=./tags/azure-functions>azure-functions (3)</a>
</div><div class=xMenu_tag>
<a href=./tags/cosmos-db>cosmos-db (3)</a>
</div><div class=xMenu_tag>
<a href=./tags/github-actions>github-actions (3)</a>
</div><div class=xMenu_tag>
<a href=./tags/github-pages>github-pages (3)</a>
</div><div class=xMenu_tag>
<a href=./tags/jekyll>jekyll (3)</a>
</div><div class=xMenu_tag>
<a href=./tags/kotlin>kotlin (3)</a>
</div><div class=xMenu_tag>
<a href=./tags/lets-encrypt>lets-encrypt (3)</a>
</div><div class=xMenu_tag>
<a href=./tags/mac>mac (3)</a>
</div><div class=xMenu_tag>
<a href=./tags/pc%E8%A8%AD%E5%AE%9A>pc設定 (3)</a>
</div><div class=xMenu_tag>
<a href=./tags/powershell>powershell (3)</a>
</div><div class=xMenu_tag>
<a href=./tags/prettier>prettier (3)</a>
</div><div class=xMenu_tag>
<a href=./tags/sqlite>sqlite (3)</a>
</div><div class=xMenu_tag>
<a href=./tags/textlint>textlint (3)</a>
</div><div class=xMenu_tag>
<a href=./tags/tv>tv (3)</a>
</div><div class=xMenu_tag>
<a href=./tags/%E3%81%8A%E3%81%A7%E3%81%8B%E3%81%91>おでかけ (3)</a>
</div><div class=xMenu_tag>
<a href=./tags/%E3%82%A2%E3%83%97%E3%83%AA>アプリ (3)</a>
</div><div class=xMenu_tag>
<a href=./tags/%E3%82%A2%E3%83%AB%E3%82%B4%E3%83%AA%E3%82%BA%E3%83%A0>アルゴリズム (3)</a>
</div><div class=xMenu_tag>
<a href=./tags/%E3%82%BB%E3%82%AD%E3%83%A5%E3%83%AA%E3%83%86%E3%82%A3>セキュリティ (3)</a>
</div><div class=xMenu_tag>
<a href=./tags/%E3%83%81%E3%83%A3%E3%83%83%E3%83%88%E3%83%9C%E3%83%83%E3%83%88>チャットボット (3)</a>
</div><div class=xMenu_tag>
<a href=./tags/%E3%83%8D%E3%83%83%E3%83%88%E3%83%AF%E3%83%BC%E3%82%AF>ネットワーク (3)</a>
</div><div class=xMenu_tag>
<a href=./tags/%E3%83%9C%E3%83%BC%E3%83%89%E3%82%B2%E3%83%BC%E3%83%A0>ボードゲーム (3)</a>
</div><div class=xMenu_tag>
<a href=./tags/%E5%83%8D%E3%81%8D%E6%96%B9>働き方 (3)</a>
</div><div class=xMenu_tag>
<a href=./tags/%E7%A7%80%E4%B8%B8>秀丸 (3)</a>
</div><div class=xMenu_tag>
<a href=./tags/%E8%87%AA%E5%88%86>自分 (3)</a>
</div><div class=xMenu_tag>
<a href=./tags/apache>apache (2)</a>
</div><div class=xMenu_tag>
<a href=./tags/arib>arib (2)</a>
</div><div class=xMenu_tag>
<a href=./tags/aws/amplify>aws/amplify (2)</a>
</div><div class=xMenu_tag>
<a href=./tags/aws/appsync>aws/appsync (2)</a>
</div><div class=xMenu_tag>
<a href=./tags/aws/codebuild>aws/codebuild (2)</a>
</div><div class=xMenu_tag>
<a href=./tags/aws/iam>aws/iam (2)</a>
</div><div class=xMenu_tag>
<a href=./tags/aws/kms>aws/kms (2)</a>
</div><div class=xMenu_tag>
<a href=./tags/aws/s3>aws/s3 (2)</a>
</div><div class=xMenu_tag>
<a href=./tags/aws/sdk>aws/sdk (2)</a>
</div><div class=xMenu_tag>
<a href=./tags/azure-app-service>azure-app-service (2)</a>
</div><div class=xMenu_tag>
<a href=./tags/excel>excel (2)</a>
</div><div class=xMenu_tag>
<a href=./tags/firebase/authentication>firebase/authentication (2)</a>
</div><div class=xMenu_tag>
<a href=./tags/go>go (2)</a>
</div><div class=xMenu_tag>
<a href=./tags/grpc>grpc (2)</a>
</div><div class=xMenu_tag>
<a href=./tags/http>http (2)</a>
</div><div class=xMenu_tag>
<a href=./tags/hugo>hugo (2)</a>
</div><div class=xMenu_tag>
<a href=./tags/npm>npm (2)</a>
</div><div class=xMenu_tag>
<a href=./tags/oauth>oauth (2)</a>
</div><div class=xMenu_tag>
<a href=./tags/opengl>opengl (2)</a>
</div><div class=xMenu_tag>
<a href=./tags/protocol-buffers>protocol-buffers (2)</a>
</div><div class=xMenu_tag>
<a href=./tags/rsync>rsync (2)</a>
</div><div class=xMenu_tag>
<a href=./tags/scp>scp (2)</a>
</div><div class=xMenu_tag>
<a href=./tags/slack>slack (2)</a>
</div><div class=xMenu_tag>
<a href=./tags/teraterm>teraterm (2)</a>
</div><div class=xMenu_tag>
<a href=./tags/unicode>unicode (2)</a>
</div><div class=xMenu_tag>
<a href=./tags/vercel>vercel (2)</a>
</div><div class=xMenu_tag>
<a href=./tags/zip>zip (2)</a>
</div><div class=xMenu_tag>
<a href=./tags/%E3%81%8A%E5%90%8D%E5%89%8D.com>お名前.com (2)</a>
</div><div class=xMenu_tag>
<a href=./tags/%E3%82%A8%E3%83%9F%E3%83%A5%E3%83%AC%E3%83%BC%E3%82%BF%E3%83%BC>エミュレーター (2)</a>
</div><div class=xMenu_tag>
<a href=./tags/%E3%83%95%E3%82%A9%E3%83%B3%E3%83%88>フォント (2)</a>
</div><div class=xMenu_tag>
<a href=./tags/%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0>プログラミング (2)</a>
</div><div class=xMenu_tag>
<a href=./tags/%E3%83%AA%E3%83%95%E3%82%A1%E3%83%AC%E3%83%B3%E3%82%B9>リファレンス (2)</a>
</div><div class=xMenu_tag>
<a href=./tags/%E5%9C%A7%E7%B8%AE%E5%B1%95%E9%96%8B>圧縮展開 (2)</a>
</div><div class=xMenu_tag>
<a href=./tags/%E6%96%87%E5%AD%97%E5%88%97>文字列 (2)</a>
</div><div class=xMenu_tag>
<a href=./tags/.net>.net (1)</a>
</div><div class=xMenu_tag>
<a href=./tags/androidstudio>androidstudio (1)</a>
</div><div class=xMenu_tag>
<a href=./tags/apollo-server>apollo-server (1)</a>
</div><div class=xMenu_tag>
<a href=./tags/atomic-design>atomic-design (1)</a>
</div><div class=xMenu_tag>
<a href=./tags/blender>blender (1)</a>
</div><div class=xMenu_tag>
<a href=./tags/bluetooth>bluetooth (1)</a>
</div><div class=xMenu_tag>
<a href=./tags/bootstrap>bootstrap (1)</a>
</div><div class=xMenu_tag>
<a href=./tags/bot-framework>bot-framework (1)</a>
</div><div class=xMenu_tag>
<a href=./tags/boto3>boto3 (1)</a>
</div><div class=xMenu_tag>
<a href=./tags/css>css (1)</a>
</div><div class=xMenu_tag>
<a href=./tags/dns>dns (1)</a>
</div><div class=xMenu_tag>
<a href=./tags/docker>docker (1)</a>
</div><div class=xMenu_tag>
<a href=./tags/dvb>dvb (1)</a>
</div><div class=xMenu_tag>
<a href=./tags/editorconfig>editorconfig (1)</a>
</div><div class=xMenu_tag>
<a href=./tags/evernote>evernote (1)</a>
</div><div class=xMenu_tag>
<a href=./tags/git>git (1)</a>
</div><div class=xMenu_tag>
<a href=./tags/groovy>groovy (1)</a>
</div><div class=xMenu_tag>
<a href=./tags/html>html (1)</a>
</div><div class=xMenu_tag>
<a href=./tags/iso>iso (1)</a>
</div><div class=xMenu_tag>
<a href=./tags/jest>jest (1)</a>
</div><div class=xMenu_tag>
<a href=./tags/json>json (1)</a>
</div><div class=xMenu_tag>
<a href=./tags/macos>macos (1)</a>
</div><div class=xMenu_tag>
<a href=./tags/parcel>parcel (1)</a>
</div><div class=xMenu_tag>
<a href=./tags/raspberrypi>raspberrypi (1)</a>
</div><div class=xMenu_tag>
<a href=./tags/ssh>ssh (1)</a>
</div><div class=xMenu_tag>
<a href=./tags/teams>teams (1)</a>
</div><div class=xMenu_tag>
<a href=./tags/tex>tex (1)</a>
</div><div class=xMenu_tag>
<a href=./tags/ubuntu>ubuntu (1)</a>
</div><div class=xMenu_tag>
<a href=./tags/url>url (1)</a>
</div><div class=xMenu_tag>
<a href=./tags/vim>vim (1)</a>
</div><div class=xMenu_tag>
<a href=./tags/vps>vps (1)</a>
</div><div class=xMenu_tag>
<a href=./tags/web>web (1)</a>
</div><div class=xMenu_tag>
<a href=./tags/webpack>webpack (1)</a>
</div><div class=xMenu_tag>
<a href=./tags/wsl>wsl (1)</a>
</div><div class=xMenu_tag>
<a href=./tags/%E3%82%A2%E3%82%B8%E3%83%A3%E3%82%A4%E3%83%AB>アジャイル (1)</a>
</div><div class=xMenu_tag>
<a href=./tags/%E3%83%90%E3%83%83%E3%83%81%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB>バッチファイル (1)</a>
</div><div class=xMenu_tag>
<a href=./tags/%E3%83%97%E3%83%AD%E3%82%AD%E3%82%B7%E8%A8%AD%E5%AE%9A>プロキシ設定 (1)</a>
</div><div class=xMenu_tag>
<a href=./tags/%E6%96%87%E5%AD%97%E3%82%B3%E3%83%BC%E3%83%89>文字コード (1)</a>
</div><div class=xMenu_tag>
<a href=./tags/%E6%96%87%E6%88%BF%E5%85%B7>文房具 (1)</a>
</div><div class=xMenu_tag>
<a href=./tags/%E6%96%99%E7%90%86>料理 (1)</a>
</div><div class=xMenu_tag>
<a href=./tags/%E6%AD%A3%E8%A6%8F%E8%A1%A8%E7%8F%BE>正規表現 (1)</a>
</div><div class=xMenu_tag>
<a href=./tags/%E7%94%BB%E5%83%8F%E5%87%A6%E7%90%86>画像処理 (1)</a>
</div><div class=xMenu_tag>
<a href=./tags/%E8%A8%80%E8%91%89>言葉 (1)</a>
</div><div class=xMenu_tag>
<a href=./tags/%E8%A8%AD%E5%AE%9A>設定 (1)</a>
</div><div class=xMenu_tag>
<a href=./tags/%E8%AA%8D%E8%A8%BC>認証 (1)</a>
</div><div class=xMenu_tag>
<a href=./tags/%E9%80%9F%E8%AA%AD>速読 (1)</a>
</div><div class=xMenu_tag>
<a href=./tags/%E9%9F%B3%E5%A3%B0%E8%AA%8D%E8%AD%98>音声認識 (1)</a>
</div></div>
</div>
<div class=xMenu_box data-sticky><br></div>
</div>
<div id=sidebar_fixed style=position:-webkit-sticky;position:sticky;top:4rem>
</div>
</div>
</nav>
<main id=xMain>
<aside>
<div class=xRecents>
<h4>新着記事</h4><div class=xRecents_item>
<a href=./p/euevcs8/>
Docker で Ansible の実行環境用のコンテナを作成する<span class=xRecents_item_tag>Ansible</span><span class=xRecents_item_tag>Docker</span><time>2022-07-02</time></a>
</div><div class=xRecents_item>
<a href=./p/n5emu3a/>
ConoHa VPS を借りて独自ドメインでアクセスできるようにする<span class=xRecents_item_tag>VPS</span><time>2022-06-27</time></a>
</div><div class=xRecents_item>
<a href=./p/oj9nzgt/>
Node.js で URL のパスを結合する (url-join)<span class=xRecents_item_tag>Node.js</span><span class=xRecents_item_tag>URL</span><time>2022-06-22</time></a>
</div></div>
</aside>
<article class=xArticle>
<div class=xArticle_content>
</div>
</article>
<article class=xArticle itemscope itemtype=https://schema.org/BlogPosting>
<header class=xArticle_headerBox>
<div>
<span class=xArticle_headerBox_breadcrumb><a href=./>&#x1F3E0;</a></span>
<span class=xArticle_headerBox_breadcrumb><a href=./p/3ftx6b2/>技術系</a></span>
<span class=xArticle_headerBox_breadcrumb><a href=./p/8t6hr3d/>Ansible</a></span></div>
<div style=display:flex;margin-top:.8em>
<div style=width:80px;margin-right:.5em>
<img src=./p/8t6hr3d/_index.svg style=width:80px;height:80px>
</div>
<div style=flex:1>
<h1 itemprop=headline class=xArticle_headerBox_title><a itemprop=mainEntityOfPage href=./p/euevcs8/>Docker で Ansible の実行環境用のコンテナを作成する</a></h1>
<div class=xPageTags>
<span class=xPageTags_item><a href=./tags/ansible>Ansible</a></span>
<span class=xPageTags_item><a href=./tags/docker>Docker</a></span>
</div>
</div>
</div>
<span class=xPageDate>
更新: <time itemprop=dateModified datetime=2022-07-02>2022-07-02</time><br>
作成: <time itemprop=datePublished datetime=2022-07-02>2022-07-02</time>
</span>
</header>
<div itemprop=articleBody class=xArticle_content>
<nav id=TableOfContents>
<ul>
<li><a href=#何をするか>何をするか？</a></li>
<li><a href=#ansible-実行環境用イメージを作成する>Ansible 実行環境用イメージを作成する</a></li>
<li><a href=#コンテナの-ansible-コマンドを実行する>コンテナの ansible コマンドを実行する</a>
<ul>
<li><a href=#ansible-コンテナ内のコマンドを実行する>ansible コンテナ内のコマンドを実行する</a></li>
<li><a href=#ansible-エイリアスansible-playbook-エイリアスを作成する>ansible エイリアス、ansible-playbook エイリアスを作成する</a></li>
<li><a href=#もう少し実践的な使用例>もう少し実践的な使用例</a></li>
</ul>
</li>
</ul>
</nav><h2 id=何をするか>何をするか？</h2>
<p>Ansible の実行環境は Python がインストールされている環境であれば比較的簡単にインストールできますが、Docker の実行環境があれば、ホスト環境に何もインストールせずに Ansible の実行環境を手に入れることができます（もちろんコンテナは作る必要はありますが）。</p>
<p>Docker Hub を見ると、Alpine Linux ベースの Ansible 実行環境用イメージ <a href=https://hub.docker.com/r/alpine/ansible>alpine/ansible</a> があるようですが、ここでは <code>Dockerfile</code> を使って自分でイメージを作成することにします。</p>
<h2 id=ansible-実行環境用イメージを作成する>Ansible 実行環境用イメージを作成する</h2>
<p><code>Dockerfile</code> で Alpine Linux ベースの Ansible 実行環境を定義します。</p>
<figure class=xCodeBlock>
<figcaption class=xCodeBlock_title>Dockerfile</figcaption>
<div class=xCodeBlock_code><div class=highlight><pre tabindex=0 class=chroma><code class=language-docker data-lang=docker><span class=k>FROM</span><span class=s> alpine:3</span><span class=err>
</span><span class=err>
</span><span class=err></span><span class=k>WORKDIR</span><span class=s> /app</span><span class=err>
</span><span class=err>
</span><span class=err></span><span class=c># --no-cache を付けることで /var/cache/apk 以下にキャッシュが残るのを防ぐ</span><span class=err>
</span><span class=err></span><span class=c># --update-cache を付けることで先に apk update するのと同じ効果になる</span><span class=err>
</span><span class=err></span><span class=k>RUN</span> apk --no-cache --update-cache add ansible openssh sshpass</code></pre></div></div>
</figure>
<p>APK (Alpine Package Keeper) で次のようなパッケージをインストールしています。</p>
<ul>
<li><code>ansible</code> &mldr; Ansible Community パッケージ（<code>ansible</code> コマンドや <code>ansible-playbook</code> コマンドなど）</li>
<li><code>openssh</code> &mldr; <code>ssh</code> コマンドのため</li>
<li><code>sshpass</code> &mldr; ターゲットホストにパスワード認証 (<code>--ask-pass</code>) で接続するときのため</li>
</ul>
<p>Ansible Community パッケージ (<code>ansible</code>) ではなく、Ansible Core (<code>ansible-core</code>) を使うようにすれば、イメージサイズは 500MB 弱から 80MB 程度に削減できますが、サイズを気にしなくてよいなら Ansible Community パッケージを使っておいた方が楽です。</p>
<p><code>Dockerfile</code> を記述したら、ビルドしてイメージを作成します。
ここではイメージ名はシンプルに <code>ansible</code> としています。</p>
<figure class=xCodeBlock>
<figcaption class=xCodeBlock_title>ansible という名前のイメージを作成</figcaption>
<div class=xCodeBlock_code><div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>$ </span>docker image build -t ansible .
</code></pre></div></div>
</figure>
<p>イメージが作成できているか確認します。</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>$ </span>docker image ls
<span class=go>REPOSITORY   TAG       IMAGE ID       CREATED          SIZE
</span><span class=go>ansible      latest    224bbc474bf8   3 minutes ago   472MB
</span></code></pre></div><h2 id=コンテナの-ansible-コマンドを実行する>コンテナの ansible コマンドを実行する</h2>
<h3 id=ansible-コンテナ内のコマンドを実行する>ansible コンテナ内のコマンドを実行する</h3>
<p>Ansible の各種コマンドをインストールした <code>ansible</code> イメージを作成したので、次のようにして <code>ansible</code> コマンドや <code>ansible-playbook</code> コマンドを実行できます。</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>#</span><span class=c1># ansible コマンドの実行</span>
<span class=gp>$ </span>docker container run --rm ansible ansible
<span class=err>
</span><span class=err></span><span class=gp>#</span><span class=c1># ansible-playbook コマンドの実行</span>
<span class=gp>$ </span>docker container run --rm ansible ansible-playbook
</code></pre></div><p><code>--rm</code> オプションを指定して実行しているので、コマンド実行後にコンテナはすぐに破棄されます。
でもよく考えたら <code>ansible-galaxy</code> による Ansible コレクションのインストールは適宜必要になるので、<code>--rm</code> オプションは外して使うことになるかもしれません。</p>
<div class=xNote>
<span class=xNote_title>☝️ コンテナのシェルを使う</span>
<span class=xNote_body><p>必要に応じて、<code>ansible</code> コンテナの <code>ash</code> シェルを使って作業することもできます。</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>$ </span>docker container run --rm -it ansible ash
<span class=go>/app # ansible --help
</span><span class=go>/app # exit
</span></code></pre></div></span>
</div>
<h3 id=ansible-エイリアスansible-playbook-エイリアスを作成する>ansible エイリアス、ansible-playbook エイリアスを作成する</h3>
<p>毎回 <code>docker container run</code> コマンドを入力するのは面倒ですし、このままだと、ホスト側のディレクトリにあるインベントリファイル (<code>inventory</code>) や Playbook ファイルを参照できないので、次のようなエイリアスを定義しておくと便利です。</p>
<figure class=xCodeBlock>
<figcaption class=xCodeBlock_title>alias-ansible.bashrc（source での読み込み用）</figcaption>
<div class=xCodeBlock_code><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=nb>alias</span> <span class=nv>ansible</span><span class=o>=</span><span class=s1>&#39;docker container run --rm -it --mount type=bind,src=&#34;$(pwd)&#34;,dst=/app ansible ansible&#39;</span>
<span class=nb>alias</span> ansible-playbook<span class=o>=</span><span class=s1>&#39;docker container run --rm -it --mount type=bind,src=&#34;$(pwd)&#34;,dst=/app ansible ansible-playbook&#39;</span></code></pre></div></div>
</figure>
<p><code>--mount</code> オプションによって、ホスト側のカレントディレクトリを、コンテナの作業ディレクトリ (<code>/app</code>) にバインドマウントしています。
SSH キー用に <code>--mount type=bind,src="$HOME/.ssh",dst=/root/.ssh</code> も追加しておいた方がいいかもしれません。
これで、あたかもホストマシンに <code>ansible</code> コマンドや <code>ansible-playbook</code> コマンドがインストールされているかのように実行できます。</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>$ </span>ansible localhost -m ping
<span class=go>[WARNING]: No inventory was parsed, only implicit localhost is available
</span><span class=go>localhost | SUCCESS =&gt; {
</span><span class=go>    &#34;changed&#34;: false,
</span><span class=go>    &#34;ping&#34;: &#34;pong&#34;
</span><span class=go>}
</span></code></pre></div><h3 id=もう少し実践的な使用例>もう少し実践的な使用例</h3>
<p><code>example.com</code> というホストに SSH 接続（パスワード認証）して <code>ping</code> モジュールを実行してみます。
まず、Ansible によるコントロール対象を記述したインベントリファイルを用意します。</p>
<figure class=xCodeBlock>
<figcaption class=xCodeBlock_title>inventory</figcaption>
<div class=xCodeBlock_code><div class=highlight><pre tabindex=0 class=chroma><code class=language-plain data-lang=plain>example.com  ansible_ssh_common_args=&#39;-o StrictHostKeyChecking=no&#39;</code></pre></div></div>
</figure>
<p>インベントリファイルでは、初回 SSH 接続時の known_hosts 未登録エラーを防ぐための <code>StrictHostKeyChecking</code> オプションを指定しています。</p>
<div class=xAccordion>
<input id=id-184256739 type=checkbox>
<label class=xAccordion_title for=id-184256739>参考: known_hosts 未登録エラーの例</label>
<div class=xAccordion_body>
<pre tabindex=0><code>example.com | FAILED! =&gt; {
    &quot;msg&quot;: &quot;Using a SSH password instead of a key is not possible because Host Key checking is enabled and sshpass does not support this.  Please add this host's fingerprint to your known_hosts file to manage this host.&quot;
}
</code></pre> </div>
</div>
<p><code>root</code> ユーザーでパスワード認証して <code>ping</code> モジュールを実行してみます。</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>$ </span>ansible -i inventory example.com -u root --ask-pass -m ping
<span class=go>SSH password: （root ユーザーのパスワードを入力）
</span><span class=go>example.com | SUCCESS =&gt; {
</span><span class=go>    &#34;ansible_facts&#34;: {
</span><span class=go>        &#34;discovered_interpreter_python&#34;: &#34;/usr/bin/python3&#34;
</span><span class=go>    },
</span><span class=go>    &#34;changed&#34;: false,
</span><span class=go>    &#34;ping&#34;: &#34;pong&#34;
</span><span class=go>}
</span></code></pre></div><p>うまくいきました！</p>
<p><code>ansible-playbook</code> コマンドも同様に実行できます。</p>
<meta itemprop=author content="まく">
<span itemprop=publisher itemscope itemtype=https://schema.org/Organization>
<meta itemprop=name content="まく">
</span>
<h3 style="border-bottom:1px solid gray">関連記事</h3>
<ul>
<li><a href=./p/uhu7hs4/>Ansible で Hello World</a></li>
<li><a href=./p/pamv6gq/>Ansible の ansible.cfg ファイルの検索順序</a></li>
<li><a href=./p/eycnx9i/>Ansible でインベントリーファイルの場所を指定する</a></li>
<li><a href=./p/m7ju6fq/>Ansible とは？ Ansible をインストールする</a></li>
</ul>
<div class=xPageTags>
<span class=xPageTags_item><a href=./tags/ansible>Ansible</a></span>
<span class=xPageTags_item><a href=./tags/docker>Docker</a></span>
</div>
</div>
<div style=text-align:right>
<div id=codoc-entry-4gYwTntzzw class=codoc-entries data-without-body=1 data-support-button-text="（っ'-')╮シュッ=͟͟͞͞ 💵" data-show-like=0 data-show-about-codoc=0 data-show-powered-by=0 data-support-message=まくに投げ銭できるよ></div>
</div>
<div class=xArticle_up>
<a href=./p/8t6hr3d/><span class=xArticle_up_label>Ansible のメモ</span><br>へ戻る</a>
</div>
</article><article class=xArticle itemscope itemtype=https://schema.org/BlogPosting>
<header class=xArticle_headerBox>
<div>
<span class=xArticle_headerBox_breadcrumb><a href=./>&#x1F3E0;</a></span>
<span class=xArticle_headerBox_breadcrumb><a href=./p/3ftx6b2/>技術系</a></span>
<span class=xArticle_headerBox_breadcrumb><a href=./p/nd3cmt3/>ネットワーク</a></span></div>
<div style=display:flex;margin-top:.8em>
<div style=width:80px;margin-right:.5em>
<img src=./p/nd3cmt3/_index.svg style=width:80px;height:80px>
</div>
<div style=flex:1>
<h1 itemprop=headline class=xArticle_headerBox_title><a itemprop=mainEntityOfPage href=./p/n5emu3a/>ConoHa VPS を借りて独自ドメインでアクセスできるようにする</a></h1>
<div class=xPageTags>
<span class=xPageTags_item><a href=./tags/vps>VPS</a></span>
</div>
</div>
</div>
<span class=xPageDate>
更新: <time itemprop=dateModified datetime=2022-06-27>2022-06-27</time><br>
作成: <time itemprop=datePublished datetime=2022-06-27>2022-06-27</time>
</span>
</header>
<div itemprop=articleBody class=xArticle_content>
<nav id=TableOfContents>
<ul>
<li><a href=#何をするか>何をするか？</a></li>
<li><a href=#conoha-のアカウントを作って-vps-を契約>ConoHa のアカウントを作って VPS を契約</a></li>
<li><a href=#独自ドメインを取得する>独自ドメインを取得する</a></li>
<li><a href=#dns-サーバーを設定する>DNS サーバーを設定する</a>
<ul>
<li><a href=#ネームサーバーを変更する>ネームサーバーを変更する</a></li>
<li><a href=#dns-に-ip-アドレス情報を設定する>DNS に IP アドレス情報を設定する</a></li>
</ul>
</li>
<li><a href=#vps-に-ipv6-アドレスを設定する>VPS に IPv6 アドレスを設定する</a></li>
<li><a href=#conoha-vps-広告>ConoHa VPS 広告</a></li>
</ul>
</nav><h2 id=何をするか>何をするか？</h2>
<p><a href="https://px.a8.net/svt/ejp?a8mat=3NCT8C+FN831U+50+4YR6O2" rel=nofollow>ConoHa の VPS</a>
<img border=0 width=1 height=1 src="https://www11.a8.net/0.gif?a8mat=3NCT8C+FN831U+50+4YR6O2" alt>
を借りたので、そのときの設定手順をメモしておきます。
大体こんな感じのことをしています。</p>
<ol>
<li><a href="https://px.a8.net/svt/ejp?a8mat=3NCT8C+FN831U+50+4YR6O2" rel=nofollow>ConoHa VPS を契約</a>
<img border=0 width=1 height=1 src="https://www11.a8.net/0.gif?a8mat=3NCT8C+FN831U+50+4YR6O2" alt>
して Ubuntu 22.04 を起動</li>
<li><a href="https://px.a8.net/svt/ejp?a8mat=3NCT8C+EVU582+50+2HHVNM" rel=nofollow>お名前.com で独自ドメインを取得</a>
<img border=0 width=1 height=1 src="https://www15.a8.net/0.gif?a8mat=3NCT8C+EVU582+50+2HHVNM" alt>
</li>
<li>独自ドメインで ConoHa VPS にアクセスできるようにする（IPv6 も有効化）</li>
</ol>
<p>ConoHa VPS はリーズナブルかつ API でのサーバー管理ができたりして、徐々に人気が高まってきてるみたいです。
安いプランであれば月額数百円で借りることができます。
Docker コンテナやデータベース (RDB) をホストするサーバーが欲しかったのですが、AWS や Azure はプライベートで使うには高すぎるので、今回は ConoHa VPS を採用しました。</p>
<p>VPS にはグローバル IP アドレスが割り当てられるので独自ドメインは必須ではないですが、やはりドメイン名でアクセスできた方がよいので、いつも通り <a href="https://px.a8.net/svt/ejp?a8mat=3NCT8C+EVU582+50+2HHVNM" rel=nofollow>お名前.com</a>
<img border=0 width=1 height=1 src="https://www15.a8.net/0.gif?a8mat=3NCT8C+EVU582+50+2HHVNM" alt>
でドメイン取得しました。
ここでは、<code>example.com</code> というドメインを取得したものとして説明しています。</p>
<h2 id=conoha-のアカウントを作って-vps-を契約>ConoHa のアカウントを作って VPS を契約</h2>
<p>何はともあれ、まずは ConoHa のアカウントを作って <a href="https://px.a8.net/svt/ejp?a8mat=3NCT8C+FN831U+50+4YR6O2" rel=nofollow>ConoHa VPS</a>
<img border=0 width=1 height=1 src="https://www11.a8.net/0.gif?a8mat=3NCT8C+FN831U+50+4YR6O2" alt>
を借ります。
ポチポチやってけば終わります。</p>
<figure class=xImage>
<a href=./p/n5emu3a/img-001.png target=_blank>
<img style="border:solid #ccc 2px" width=1932 height=412 src=./p/n5emu3a/img-001.png alt=/p/n5emu3a/img-001.png>
</a>
<figcaption>図: ConoHa VPS での OS の選択</figcaption>
</figure>
<p>VPS の初期 OS として、<strong>Ubuntu 22.04</strong> を選択しました。
上記は選択できる OS の一例ですが、他にもいろいろあります。</p>
<h2 id=独自ドメインを取得する>独自ドメインを取得する</h2>
<p>ConoHa VPS に割り当てる独自ドメインを取得しておきます。
ドメインはどこで取得してもいいんですが、あまりいろいろな会社に散らばると面倒なので、わたしの場合はお名前.com に統一しています。
ConoHa でもドメイン取得できるので、そちらで取得しても大丈夫です。</p>
<ul>
<li><a href="https://px.a8.net/svt/ejp?a8mat=3NCT8C+EVU582+50+2HHVNM" rel=nofollow>ドメイン取るなら - お名前.com</a>
<img border=0 width=1 height=1 src="https://www15.a8.net/0.gif?a8mat=3NCT8C+EVU582+50+2HHVNM" alt>
</li>
</ul>
<p>ここでは、<code>example.com</code> というドメインを取得したとして説明していきます。
毎度のことなんですが、ドメイン名を考えるのが一番時間がかかりますねｗ
ドメインの更新料金は 1 年ごとに数千円程度ですが、1 年目は数百円だったりします。</p>
<h2 id=dns-サーバーを設定する>DNS サーバーを設定する</h2>
<p>独自ドメインを取得したら、そのドメイン名で ConoHa VPS のサーバーにアクセスできるようにします。
つまり、<code>example.com</code> から <code>160.xxx.xxx.xxx</code> のような IP アドレスを引けるようにします。</p>
<ul>
<li>参考: <a href=./p/bwamwgp/>ドメイン管理と DNS 管理の違いを理解する</a></li>
</ul>
<h3 id=ネームサーバーを変更する>ネームサーバーを変更する</h3>
<p>お名前.com でドメインを取得すると、そのドメインの IP アドレスは次のような DNS サーバーで管理するよう初期設定されています。</p>
<ul>
<li><code>dns1.onamae.com</code> / <code>dns2.onamae.com</code></li>
</ul>
<p>この状態で、Web ブラウザから独自ドメインにアクセス (<code>http://example.com</code>) すると、お名前.com の「ようこそ」的な Web ページが表示されるようになっています。
このままではダメなので、DNS サーバーを変更して、その DNS サーバーで正しい IP アドレスを関連づけてやります。
お名前.com が用意している次のような DNS サーバーを使うこともできますが、</p>
<ul>
<li><code>01.dnsv.jp</code> / <code>02.dnsv.jp</code></li>
</ul>
<p>今回はせっかくなので、ConoHa が提供している DNS サーバーを使ってみます。
お名前.com Navi にログインして、次のように使用する DNS サーバーを変更します。</p>
<figure class=xImage>
<a href=./p/n5emu3a/img-002.png target=_blank>
<img style="border:solid #ccc 2px" width=1500 height=499 src=./p/n5emu3a/img-002.png alt=/p/n5emu3a/img-002.png>
</a>
<figcaption>図: お名前.com のネームサーバー変更</figcaption>
</figure>
<ol>
<li><code>ネームサーバーの設定</code> → <code>ネームサーバーの設定</code> と選択する</li>
<li>取得したドメイン名 (<code>example.com</code>) を選択する</li>
<li><code>他のネームサーバーを利用</code> を選択して、次のような ConoHa 側の DNS サーバーを登録する
<ul>
<li><strong><code>ns-a1.conoha.io</code></strong></li>
<li><strong><code>ns-a2.conoha.io</code></strong></li>
<li><strong><code>ns-a3.conoha.io</code></strong></li>
</ul>
</li>
</ol>
<h3 id=dns-に-ip-アドレス情報を設定する>DNS に IP アドレス情報を設定する</h3>
<p>次に、<a href=https://manage.conoha.jp/Dashboard>ConoHa 側のコントールパネル</a> で DNS サーバーの設定をします。
ここで、ドメイン名と IP アドレスを関連付けます。
まず、コントロールパネルから VPS サーバー情報を開いて、割り当てられた IPv4 アドレス（<code>160.xxx.xxx.xxx</code> など）を確認しておきます。</p>
<ul>
<li><a href=https://manage.conoha.jp/Service/>ConoHa コントロールパネル - サーバーリスト</a></li>
</ul>
<p>また、そこで IPv6 として割り当て可能なアドレスのリストも確認できるので、一番上のアドレス（<code>2400:8500:1801:XXX:XXX:XXX:XX:XX</code> など）とゲートウェイのアドレスを控えておきます。
VPS に最初から 17 個の IPv6 アドレスが割り当てられているように見えますが、それは罠で、自分で VPS に設定しないといけません（後述）。
IP アドレスがわかったら、DNS の設定画面を開いて、A レコード（IPv4 アドレス）と AAAA レコード（IPv6 アドレス）として登録します。</p>
<ul>
<li><a href=https://manage.conoha.jp/DNS/>ConoHa コントロールパネル - サーバーリスト</a></li>
</ul>
<figure class=xImage>
<a href=./p/n5emu3a/img-003.png target=_blank>
<img style="border:solid #ccc 2px" width=2034 height=868 src=./p/n5emu3a/img-003.png alt=/p/n5emu3a/img-003.png>
</a>
<figcaption>図: DNS レコードの追加</figcaption>
</figure>
<ol>
<li>取得したドメイン (<code>example.com</code>) を追加</li>
<li>編集ボタンを押して、A レコードとして IPv4 アドレスを追加します。
<ul>
<li>例: 名称: <code>@</code>, TTL: <code>3600</code>, VALUE: <code>160.xxx.xxx.xxx</code></li>
</ul>
</li>
<li>IPv6 アドレスも割り当てたい場合は、AAAA レコードも追加します。
<ul>
<li>例: 名称: <code>@</code>, TTL: <code>3600</code>, VALUE: <code>2400:8500:1801:XXX:XXX:XXX:XX:XX</code></li>
</ul>
</li>
</ol>
<p>以上の設定を終えて 10 分くらい待つと、<code>ping examle.com</code> が通るようになります。
ただし、デフォルトでは VPS に IPv6 のアドレスは割り当てられていないので、VPS の設定を変更して IPv6 を有効化します。</p>
<h2 id=vps-に-ipv6-アドレスを設定する>VPS に IPv6 アドレスを設定する</h2>
<p>ConoHa VPS に IPv6 のアドレスを割り当てる方法として、下記のマニュアルが用意されていますが、これは CentOS 用のものみたいです（2022年6月現在）。
Ubuntu では Netplan でネットワーク設定するので、そのやり方をメモっておきます。</p>
<ul>
<li>参考: <a href="https://support.conoha.jp/v/setipv6/?btn_id=v-port-sidebar_v-setipv6">ConoHa - ご利用ガイド IPv6 を VPS へ設定する</a></li>
<li>参考: <a href=./p/7q3dnx8/>Linuxメモ: Netplan で Ubuntu のネットワーク設定を行う</a></li>
</ul>
<p>以下のファイル編集作業は、次のように SSH 接続するか、ConoHa コントロールパネルからコンソールを開いて行います。</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>$ </span>ssh root@example.com
</code></pre></div><p>ConoHa VPS の Ubuntu 22.04 の初期設定では、Netplan の設定ファイルとして下記のファイルだけが入っています。
IPv4 は DHCP が有効になっていますが、うまく固定のアドレスが割り当てられているようです。</p>
<figure class=xCodeBlock>
<figcaption class=xCodeBlock_title>vi /etc/netplan/10-gmovps.yaml</figcaption>
<div class=xCodeBlock_code><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=nt>network</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>ethernets</span><span class=p>:</span><span class=w>
</span><span class=w>        </span><span class=nt>eth0</span><span class=p>:</span><span class=w>
</span><span class=w>            </span><span class=nt>addresses</span><span class=p>:</span><span class=w> </span><span class=p>[]</span><span class=w>
</span><span class=w>            </span><span class=nt>dhcp4</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span><span class=w>            </span><span class=nt>dhcp6</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span><span class=w>            </span><span class=nt>accept-ra</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span><span class=w>            </span><span class=nt>optional</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span><span class=w>    </span><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=m>2</span></code></pre></div></div>
</figure>
<p>このファイルを書き換えてもよいのですが、IPv6 設定用のファイルを別に用意することにします。</p>
<figure class=xCodeBlock>
<figcaption class=xCodeBlock_title>vi /etc/netplan/99-custom.yaml</figcaption>
<div class=xCodeBlock_code><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=nt>network</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>ethernets</span><span class=p>:</span><span class=w>
</span><span class=w>        </span><span class=nt>eth0</span><span class=p>:</span><span class=w>
</span><span class=w>            </span><span class=nt>addresses</span><span class=p>:</span><span class=w>
</span><span class=w>            </span>- <span class=s2>&#34;2400:8500:XXXX:XXX:XXX:XXX:XX:XX/64&#34;</span><span class=w>  </span><span class=c># IPv6 アドレスを設定</span><span class=w>
</span><span class=w>            </span><span class=nt>dhcp6</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span><span class=w>            </span><span class=nt>accept-ra</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span><span class=w>            </span><span class=nt>optional</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span><span class=w>            </span><span class=nt>routes</span><span class=p>:</span><span class=w>
</span><span class=w>            </span>- <span class=nt>to</span><span class=p>:</span><span class=w> </span><span class=l>default</span><span class=w>
</span><span class=w>              </span><span class=nt>via</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;2400:8500:XXXX:XXX::1&#34;</span><span class=w>  </span><span class=c># デフォルトゲートウェイを設定</span><span class=w>
</span><span class=w>    </span><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=m>2</span></code></pre></div></div>
</figure>
<p>あとは、次のように Netplan の設定を反映すれば、IPv6 の設定完了です。</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp># </span>netplan apply
</code></pre></div><p><a href=./p/p7q7n4i/>ip コマンド</a> で IPv6 アドレスやデフォルトゲートウェイが正しく割り当てられているか確認しておきます。</p>
<figure class=xCodeBlock>
<figcaption class=xCodeBlock_title>IPv6 アドレスの確認</figcaption>
<div class=xCodeBlock_code><div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>$ </span>ip a show dev eth0
<span class=go>2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP group default qlen 1000
</span><span class=go>    link/ether 02:02:a0:fb:XX:XX brd ff:ff:ff:ff:ff:ff
</span><span class=go>    altname enp0s3
</span><span class=go>    altname ens3
</span><span class=go>    inet 160.XXX.XXX.XXX/23 metric 100 brd 160.XXX.XXX.255 scope global dynamic eth0
</span><span class=go>       valid_lft 5183492sec preferred_lft 5183492sec
</span><span class=go>    inet6 2400:8500:XXXX:XXX:XXX:XXX:XX:XX/64 scope global
</span><span class=go>       valid_lft forever preferred_lft forever
</span><span class=go>    inet6 fe80::2:a0ff:fefb:330a/64 scope link
</span><span class=go>       valid_lft forever preferred_lft forever
</span></code></pre></div></div>
</figure>
<figure class=xCodeBlock>
<figcaption class=xCodeBlock_title>デフォルトゲートウェイの確認</figcaption>
<div class=xCodeBlock_code><div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>$ </span>ip -6 route
<span class=go>::1 dev lo proto kernel metric 256 pref medium
</span><span class=go>2400:8500:XXXX:XXX::/64 dev eth0 proto kernel metric 256 pref medium
</span><span class=go>fe80::/64 dev eth0 proto kernel metric 256 pref medium
</span><span class=go>default via 2400:8500:XXXX:XXX::1 dev eth0 proto static metric 1024 pref medium
</span></code></pre></div></div>
</figure>
<p>IPv6 で外部サーバー (google.com) に <code>ping6</code> できることも確認しておきます。</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>$ </span>ping6 -c <span class=m>3</span> -I eth0 google.com
<span class=go>PING google.com(nrt12s30-in-x0e.1e100.net (2404:6800:4004:812::200e)) from 2400:8500:XXXX:XXX:XXX:XXX:XX:XX eth0: 56 data bytes
</span><span class=go>64 bytes from nrt12s30-in-x0e.1e100.net (2404:6800:4004:812::200e): icmp_seq=1 ttl=56 time=1.03 ms
</span><span class=go>64 bytes from nrt12s30-in-x0e.1e100.net (2404:6800:4004:812::200e): icmp_seq=2 ttl=56 time=0.838 ms
</span><span class=go>64 bytes from nrt12s30-in-x0e.1e100.net (2404:6800:4004:812::200e): icmp_seq=3 ttl=56 time=0.833 ms
</span></code></pre></div><p>逆に、手元の PC から ConoHa VPS に <code>ping6</code> できることも確認しておきます。</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>$ </span>ping6 example.com
<span class=go>...（省略）...
</span></code></pre></div><p>これで、独自ドメインで ConoHa VPS にアクセスできるようになりました！</p>
<h2 id=conoha-vps-広告>ConoHa VPS 広告</h2>
<p>最後に、お得な広告を貼っておきます（＾＾</p>
<ul>
<li><strong>ConoHa VPS</strong> の申し込みはこちらから →
<a href="https://px.a8.net/svt/ejp?a8mat=3NCT8C+FN831U+50+4YV1K1" rel=nofollow>
<img border=0 width=234 height=60 alt src="https://www24.a8.net/svt/bgt?aid=220627452946&wid=001&eno=01&mid=s00000000018030042000&mc=1"></a>
<img border=0 width=1 height=1 src="https://www15.a8.net/0.gif?a8mat=3NCT8C+FN831U+50+4YV1K1" alt>
</li>
<li>お名前.com での <strong>ドメイン取得</strong> はこちらから →
<a href="https://px.a8.net/svt/ejp?a8mat=3NCT8C+EVU582+50+2HBVLT" rel=nofollow>
<img border=0 width=234 height=60 alt src="https://www20.a8.net/svt/bgt?aid=220627452900&wid=001&eno=01&mid=s00000000018015004000&mc=1"></a>
<img border=0 width=1 height=1 src="https://www11.a8.net/0.gif?a8mat=3NCT8C+EVU582+50+2HBVLT" alt>
</li>
</ul>
<meta itemprop=author content="まく">
<span itemprop=publisher itemscope itemtype=https://schema.org/Organization>
<meta itemprop=name content="まく">
</span>
<div class=xPageTags>
<span class=xPageTags_item><a href=./tags/vps>VPS</a></span>
</div>
</div>
<div style=text-align:right>
<div id=codoc-entry-4gYwTntzzw class=codoc-entries data-without-body=1 data-support-button-text="（っ'-')╮シュッ=͟͟͞͞ 💵" data-show-like=0 data-show-about-codoc=0 data-show-powered-by=0 data-support-message=まくに投げ銭できるよ></div>
</div>
<div class=xArticle_up>
<a href=./p/nd3cmt3/><span class=xArticle_up_label>ネットワーク関連技術メモ</span><br>へ戻る</a>
</div>
</article><article class=xArticle itemscope itemtype=https://schema.org/BlogPosting>
<header class=xArticle_headerBox>
<div>
<span class=xArticle_headerBox_breadcrumb><a href=./>&#x1F3E0;</a></span>
<span class=xArticle_headerBox_breadcrumb><a href=./p/3ftx6b2/>技術系</a></span>
<span class=xArticle_headerBox_breadcrumb><a href=./p/ujqinda/>プログラミング</a></span>
<span class=xArticle_headerBox_breadcrumb><a href=./p/fn7m2gu/>JavaScript / Node.js</a></span></div>
<div style=display:flex;margin-top:.8em>
<div style=width:80px;margin-right:.5em>
<img src=./p/fn7m2gu/_index.svg style=width:80px;height:80px>
</div>
<div style=flex:1>
<h1 itemprop=headline class=xArticle_headerBox_title><a itemprop=mainEntityOfPage href=./p/oj9nzgt/>Node.js で URL のパスを結合する (url-join)</a></h1>
<div class=xPageTags>
<span class=xPageTags_item><a href=./tags/node.js>Node.js</a></span>
<span class=xPageTags_item><a href=./tags/url>URL</a></span>
</div>
</div>
</div>
<span class=xPageDate>
更新: <time itemprop=dateModified datetime=2022-06-22>2022-06-22</time><br>
作成: <time itemprop=datePublished datetime=2022-06-22>2022-06-22</time>
</span>
</header>
<div itemprop=articleBody class=xArticle_content>
<nav id=TableOfContents></nav><p>José F. Romaniello 氏 (jfromaniello) が公開している NPM パッケージの <a href=https://www.npmjs.com/package/url-join>url-join</a> を使うと、バラバラになった URL のパスをうまいこと結合してくれます。</p>
<figure class=xCodeBlock>
<figcaption class=xCodeBlock_title>url-join のインストール</figcaption>
<div class=xCodeBlock_code><div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=gp>$ </span>npm install url-join
</code></pre></div></div>
</figure>
<figure class=xCodeBlock>
<figcaption class=xCodeBlock_title>使用例</figcaption>
<div class=xCodeBlock_code><div class=highlight><pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=kr>import</span> <span class=nx>urlJoin</span> <span class=kr>from</span> <span class=s1>&#39;url-join&#39;</span>

<span class=nx>urlJoin</span><span class=p>(</span><span class=s1>&#39;https://example.com&#39;</span><span class=p>,</span> <span class=s1>&#39;a&#39;</span><span class=p>,</span> <span class=s1>&#39;/b/c&#39;</span><span class=p>))</span>        <span class=c1>//=&gt; https://example.com/a/b/c
</span><span class=c1></span><span class=nx>urlJoin</span><span class=p>(</span><span class=s1>&#39;https://example.com/&#39;</span><span class=p>,</span> <span class=s1>&#39;/a&#39;</span><span class=p>,</span> <span class=s1>&#39;/b/c/&#39;</span><span class=p>))</span>     <span class=c1>//=&gt; https://example.com/a/b/c/
</span><span class=c1></span><span class=nx>urlJoin</span><span class=p>(</span><span class=s1>&#39;https://example.com&#39;</span><span class=p>,</span> <span class=s1>&#39;/foo&#39;</span><span class=p>,</span> <span class=s1>&#39;?q=123&#39;</span><span class=p>))</span>   <span class=c1>//=&gt; https://example.com/foo?q=123
</span><span class=c1></span><span class=nx>urlJoin</span><span class=p>(</span><span class=s1>&#39;https://example.com&#39;</span><span class=p>,</span> <span class=s1>&#39;foo/&#39;</span><span class=p>,</span> <span class=s1>&#39;/?q=123&#39;</span><span class=p>))</span>  <span class=c1>//=&gt; https://example.com/foo?q=123
</span></code></pre></div></div>
</figure>
<p>URL の末尾にクエリ文字列 (<code>?q=123</code>) があるときは、パス部分の末尾の <code>/</code> は消されちゃうみたいですね。</p>
<div class=xNote>
<span class=xNote_title>☝️ path.join は URL 結合には使えない</span>
<span class=xNote_body><code>path</code> モジュールの <code>path.join</code> は、ローカルファイルシステム用のパス結合関数なので、URL の結合には使ってはいけません。
例えば、Windows 環境ではバックスラッシュが使われてしまったりします。</span>
</div>
<meta itemprop=author content="まく">
<span itemprop=publisher itemscope itemtype=https://schema.org/Organization>
<meta itemprop=name content="まく">
</span>
<h3 style="border-bottom:1px solid gray">関連記事</h3>
<ul>
<li><a href=./p/ryq6it6/>NPM パッケージを作るときの package.json ファイルの書き方に関してのメモ</a></li>
<li><a href=./p/zn2er4g/>VS Code でビルドタスクやテストタスクを登録する (tasks.json)</a></li>
<li><a href=./p/4m96s2r/>Azure Table Stroage を使ってみる: TableService を Promise 化して使いやすくする</a></li>
<li><a href=./p/ccoonon/>Azure Table Strage を使ってみる (4) Node.js からテーブル操作してみる</a></li>
<li><a href=./p/fn3amda/>チャットボット: 独自のミドルウェアを作成してログを記録する</a></li>
<li><a href=./p/gt9g2na/>チャットボット: 独自のミドルウェアを作成して禁止ワードを拒否するようにする</a></li>
<li><a href=./p/6arjar6/>チャットボット: Bot Builder SDK の Dialog で会話の流れをデザインする (2) スタック管理</a></li>
</ul>
<div class=xPageTags>
<span class=xPageTags_item><a href=./tags/node.js>Node.js</a></span>
<span class=xPageTags_item><a href=./tags/url>URL</a></span>
</div>
</div>
<div style=text-align:right>
<div id=codoc-entry-4gYwTntzzw class=codoc-entries data-without-body=1 data-support-button-text="（っ'-')╮シュッ=͟͟͞͞ 💵" data-show-like=0 data-show-about-codoc=0 data-show-powered-by=0 data-support-message=まくに投げ銭できるよ></div>
</div>
<div class=xArticle_up>
<a href=./p/fn7m2gu/><span class=xArticle_up_label>JavaScript / Node.js 関連メモ</span><br>へ戻る</a>
</div>
</article><h2>メニュー</h2>
<div class=xTopMenu>
<div class=xTopMenu_item>
<a href=./p/3ftx6b2/><p>技術系</p></a>
</div>
<div class=xTopMenu_item>
<a href=./p/zb9ocav/><p>ツール</p></a>
</div>
<div class=xTopMenu_item>
<a href=./p/35odek9/><p>読書</p></a>
</div>
<div class=xTopMenu_item>
<a href=./p/ajj5753/><p>遊び</p></a>
</div>
<div class=xTopMenu_item>
<a href=./p/qb73pxx/><p>日記・コラム</p></a>
</div>
<div class=xTopMenu_item>
<a href=./p/syy4ryp/><p>設定</p></a>
</div>
<div class=xTopMenu_item>
<a href=./p/tsjyzrn/><p>雑多</p></a>
</div>
<div class=xTopMenu_item>
<a href=./p/hnoamfo/><p>管理人</p></a>
</div>
</div>
<script async src=//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script>
<ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=fluid data-ad-client=ca-pub-6317852277883092 data-ad-slot=8636867067></ins>
<script>(adsbygoogle=window.adsbygoogle||[]).push({})</script>
</main>
</div>
<div id=xSiteFooter><a href=./>まくろぐ</a></div>
<div id=xSiteFooter2>
<a href=./sitemap/>サイトマップ</a> ｜
<a tatget=_blank href=https://forms.gle/xdUszEv4f5CEqH947>まくへのメッセージ</a>
</div>
</div>
<script src=./assets/js/sidebar.js></script>
<script>document.addEventListener('DOMContentLoaded',function(){const a=document.querySelectorAll('a[href^=http]');for(let c=0;c<a.length;++c){const b=a[c];b.setAttribute('target','_blank'),b.setAttribute('rel','noopener');const d=b.getElementsByTagName('img');if(d.length>0)continue;b.classList.add('xExternalLinkIcon')}})</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"まくろぐ","item":"https://maku.blog/"}]}</script>
</body>
</html>